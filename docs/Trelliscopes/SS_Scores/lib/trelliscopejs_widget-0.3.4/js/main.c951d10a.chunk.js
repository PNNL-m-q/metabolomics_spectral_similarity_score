(this["webpackJsonptrelliscopejs-lib"]=this["webpackJsonptrelliscopejs-lib"]||[]).push([[0],{183:function(e,t,a){e.exports=a(219)},193:function(e,t,a){},194:function(e,t,a){},195:function(e,t,a){},219:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(17),l=a.n(o),r=a(13),s=a(52),c=a(132),d=a(133),p=a(156),h=a(306),m=(a(192),a(114)),g=a.n(m),u=a(115),b=a.n(u);const f=["Panel Grid Layout","Filter Panels","Sort Panels","Show/Hide Labels","Views"],v={};f.forEach((e,t)=>{v[e]=t}),v[""]=-1;const y=e=>t=>a=>{const n=["SELECT_DISPLAY","SET_LAYOUT","SET_LABELS","SET_SORT","SET_FILTER","ACTIVE_SIDEBAR","SET_FILTER_VIEW","SET_STATIC_VIEW"],i=t(a);if(n.indexOf(a.type)>-1){const t=(e=>{const t=e.selectedDisplay,a=e.layout,n="nrow=".concat(a.nrow,"&ncol=").concat(a.ncol,"&arr=").concat(a.arrange,"&pg=").concat(a.pageNum),i=e.labels,o=e.sort;o.sort((e,t)=>e.order>t.order?1:-1);const l=o.map(e=>"".concat(e.name,";").concat(e.dir)).join(","),r=e.filter,s=Object.keys(r.state).map(e=>{const t=r.state[e];let a="";if("select"===t.type)a="var:".concat(t.name,";type:select;val:").concat(t.value.map(encodeURIComponent).join("#"));else if("regex"===t.type)a="var:".concat(t.name,";type:regex;val:").concat(encodeURIComponent(t.regex));else if("range"===t.type){const e=t.value.from?t.value.from:"",n=t.value.to?t.value.to:"";a="var:".concat(t.name,";type:range;from:").concat(e,";to:").concat(n)}return a}),c=e.staticView,d=e.sidebar,p=v[d.active];let h="";r.view.active&&(h=r.view.active.join(","));return"display=".concat(t.name,"&").concat(n,"&labels=").concat(i.join(","),"&sort=").concat(l,"&filter=").concat(s.join(","),"&sidebar=").concat(p,"&fv=").concat(h,"&staticView=").concat(c)})(e.getState());window.location.hash!==t&&(window.location.hash=t)}return i},E=(e,t)=>e.classList?e.classList.contains(t):!!e.className.match(new RegExp("'(\\s|^)'".concat(t,"'(\\s|$)'"))),w=(e,t)=>{e.classList?e.classList.add(t):E(e,t)||(e.className+=" ".concat(t))},x=(e,t)=>{if(e.classList)e.classList.remove(t);else if(E(e,t)){const a=new RegExp("'(\\s|^)'".concat(t,"'(\\s|$)'"));e.className=e.className.replace(a," ")}};a(193),a(194),a(195);var S=a(103),_=a(157),O=a(158),C=a(62),k=a.n(C);const I=e=>{const t=window.HTMLWidgets.widgets;for(let a=0;a<t.length;a+=1)if(t[a].name===e)return t[a]};var N=a(113),D=a.n(N),j=a(134);const T=(e,t,a)=>"".concat(e.group,"_:_").concat(e.name,"_:_").concat(t,"_:_").concat(a),L=(e,t,a,n)=>{const i=T(e,a,n);if("API"===e.input_type){const o={display_id:"".concat(e.group,"___").concat(e.name),display_version:"v1",panel_id:a,cog_id:n,val:encodeURIComponent(localStorage.getItem(i)===t?"":t)},l=Object.entries(o).map(e=>e.join("=")).join("&");fetch("".concat(e.input_api.set,"?").concat(l),e.input_api.setRequestOptions).then(function(){var e=Object(j.a)(D.a.mark((function e(a){var n,o,l,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null===(n=a.headers.get("content-type"))||void 0===n?void 0:n.includes("application/json"),e.t0=o,!e.t0){e.next=6;break}return e.next=5,a.json();case 5:e.t0=e.sent;case 6:if(l=e.t0,a.ok){e.next=10;break}return r=l&&l.message||a.status,e.abrupt("return",Promise.reject(r));case 10:return localStorage.getItem(i)===t?localStorage.removeItem(i):localStorage.setItem(i,t),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(e=>{console.error("There was an error setting the input.",e)})}"localStorage"===e.input_type&&(localStorage.getItem(i)===t?localStorage.removeItem(i):localStorage.setItem(i,t))},R=e=>Object(S.a)(e.url,t=>e.callback(t)),A=e=>({type:"WINDOW_RESIZE",dims:e}),z=e=>({type:"UPDATE_DIMS",dims:e}),P=e=>({type:"RECEIVE_CONFIG",config:e,receivedAt:Date.now()}),F=e=>({type:"ACTIVE_SIDEBAR",active:e}),W=e=>({type:"SET_DIALOG_OPEN",isOpen:e}),B=e=>({type:"SET_DISPSELECT_DIALOG_OPEN",isOpen:e}),H=e=>({type:"SET_DISPINFO_DIALOG_OPEN",isOpen:e}),V=e=>({type:"SET_LAYOUT",layout:e}),M=e=>({type:"SET_LABELS",labels:e}),U=e=>({type:"SET_SORT",sort:e}),G=e=>({type:"SET_FILTER",filter:e}),K=(e,t)=>({type:"SET_FILTER_VIEW",name:e,which:t}),Y=e=>({type:"RECEIVE_DISPLAY_LIST",list:e,receivedAt:Date.now()}),q=(e,t,a)=>({type:"SELECT_DISPLAY",name:e,group:t,desc:a}),Q=e=>({type:"SET_SELECTED_RELDISPS",which:"set",val:e}),J=e=>({type:"SET_REL_DISP_POSITIONS",obj:e}),$=(e,t)=>({type:"REQUEST_DISPLAY",name:e,group:t}),X=(e,t,a)=>({type:"RECEIVE_DISPLAY",name:e,group:t,info:a,receivedAt:Date.now()}),Z=(e,t)=>({type:"RECEIVE_COGDATA",iface:e,crossfilter:t,receivedAt:Date.now()}),ee=(e,t)=>({type:"SET_PANEL_RENDERER",name:e,fn:t}),te=e=>({type:"SET_ERROR_MESSAGE",msg:e}),ae=(e,t,a,n,i)=>{const o={};i.replace("#","").split("&").forEach(e=>{const t=e.split("=");o[t[0]]=t[[1]]});for(let g=0;g<t.length;g+=1)t[g].__index=g;n(Z(e,Object(_.a)(t)));let l=a.state.sidebar;o.sidebar&&(l=parseInt(o.sidebar,10)),l&&l>=0&&n(F(f[l]));const r=a.state.layout;o.nrow&&(r.nrow=parseInt(o.nrow,10)),o.ncol&&(r.ncol=parseInt(o.ncol,10)),o.arr&&(r.arrange=o.arr),n(V(r)),o.pg&&n(V({pageNum:parseInt(o.pg,10)}));let s=a.state.labels;o.labels&&(s=o.labels.split(",")),n(M(s));let c=a.state.sort;o.sort&&(c=o.sort.split(",").map((e,t)=>{const a=e.split(";");return{order:t+1,name:a[0],dir:a[1]}})),n(U(c));const d=a.state.filter?a.state.filter:{};if(o.filter){o.filter.split(",").forEach(e=>{const t={};e.split(";").forEach(e=>{const a=e.split(":");t[a[0]]=a[[1]]});const n={name:t.var,type:t.type,varType:a.cogInfo[t.var].type};if("select"===t.type)n.orderValue="ct,desc",n.value=t.val.split("#").map(decodeURIComponent);else if("regex"===t.type){const e=a.cogInfo[t.var].levels,i=[],o=new RegExp(decodeURIComponent(t.val),"i");e.forEach(e=>{null!==e.match(o)&&i.push(e)}),n.regex=t.val,n.value=i,n.orderValue="ct,desc"}else if("range"===t.type){const e=t.from?parseFloat(t.from,10):void 0,a=t.to?parseFloat(t.to,10):void 0;n.value={from:e,to:a},n.valid=!0,e&&a&&e>a&&(n.valid=!1)}d[t.var]=n})}let p=a.state.fv?a.state.fv:[];o.fv&&(p=o.fv.split(","));const h=Object.keys(a.cogInfo),m={active:[],inactive:[]};for(let g=0;g<h.length;g+=1)a.cogInfo[h[g]].filterable&&(p.includes(h[g])||a.state.filter&&void 0!==a.state.filter[h[g]]?m.active.push(h[g]):m.inactive.push(h[g]));n(K(m,"set")),n(G(d)),o.staticView&&""!==o.staticView&&n({type:"SET_STATIC_VIEW",val:o.staticView})},ne=(e,t,a)=>{if("image"===e.panelInterface.type)a(ee(e.name,(e,t,a)=>i.a.createElement("img",{src:e,alt:"panel",style:{width:t,height:a}})));else if("image_src"===e.panelInterface.type)a(ee(e.name,e=>i.a.createElement("img",{src:e,alt:"panel",style:{width:"100%",height:"100%",objectFit:"contain"}})));else if("htmlwidget"===e.panelInterface.type){const n=()=>{const t=I(e.panelInterface.deps.name);a(ee(e.name,(e,a,n,o,l)=>{const r=document.getElementById("widget_outer_".concat(l)),s=document.getElementById("widget_".concat(l));if(!o||!r||null!==s)return i.a.createElement("div",{id:"widget_outer_".concat(l)});{const i=document.createElement("div");let o;i.style.width="".concat(a,"px"),i.style.height="".concat(n,"px"),i.setAttribute("id","widget_".concat(l)),r.appendChild(i),t.initialize&&(o=t.initialize(i,a,n)),e.evals instanceof Array||(e.evals=[e.evals]);for(let t=0;e.evals&&t<e.evals.length;t+=1)window.HTMLWidgets.evaluateStringMember(e.x,e.evals[t]);t.renderValue(i,e.x,o)}return null}))};t.config_base?((e,t,a)=>{function n(e,t){return new Promise((a,n)=>{e.onload=()=>{a(t)},e.onerror=()=>{n(t)},document.body.appendChild(e)})}let i=[];e.assets.forEach(e=>{let a=e.url;Array.isArray(a)||(a=[a]);for(let o=0;o<a.length;o+=1){let l;"script"===e.type?(l=document.createElement("script"),l.type="text/javascript",l.src="".concat(t).concat(a[o])):"stylesheet"===e.type&&(l=document.createElement("link"),l.rel="stylesheet",l.type="text/css",l.href="".concat(t).concat(a[o])),l.async=!1,i.push(n(l,a[o]))}}),Promise.all(i).then(()=>{a()}).catch(e=>{})})(e.panelInterface.deps,t.config_base,n):"__self__"===t.display_base&&n()}},ie=(e,t,a,n="",i="",o=!0)=>l=>{l($(e,t));const r="__loadDisplayObj__".concat(n,"_").concat(t,"_").concat(e),s="__loadCogData__".concat(n,"_").concat(t,"_").concat(e);window[r]=n=>{const r=n.cogInterface;l(X(e,t,n)),ne(n,a,l),n.showMdDesc&&l(H(!0)),o&&(l(Z(r)),window[s]=e=>{ae(r,e,n,l,i)},"jsonp"===a.data_type?k()({url:"".concat(a.display_base).concat(r.group,"/").concat(r.name,"/cogData.jsonp"),callbackName:"cdCallback",error:e=>l(te("Couldn't load cognostics data: ".concat(e.url)))}):R({url:"".concat(a.display_base).concat(r.group,"/").concat(r.name,"/cogData.json"),callback:window[s]}).on("error",e=>l(te("Couldn't load display list: ".concat(e.target.responseURL)))),n.has_inputs&&"API"===n.input_type&&(e=>{const t={display_id:"".concat(e.group,"___").concat(e.name),display_version:"v1"},a=Object.entries(t).map(e=>e.join("=")).join("&");fetch("".concat(e.input_api.get,"?").concat(a),e.input_api.getRequestOptions).then(e=>{var t;const a=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))&&e.json();if(!e.ok){return a&&a.message||e.status}return e.json()}).then(t=>{if(t.success){const a=new RegExp("^".concat((e=>"".concat(e.group,"_:_").concat(e.name,"_:"))(e)),"g");Object.keys(localStorage).forEach(e=>{e.match(a)&&localStorage.removeItem(e)}),Object.keys(t.panels).forEach(a=>{Object.keys(t.panels[a]).forEach(n=>{const i=T(e,a,n),o=t.panels[a][n];""!==o&&localStorage.setItem(i,o)})})}}).catch(e=>{console.error("There was an error getting inputs stored in the API.",e)})})(n))},"jsonp"===a.data_type?k()({url:"".concat(a.display_base).concat(t,"/").concat(e,"/displayObj.jsonp"),callbackName:"ldCallback",error:e=>l(te("Couldn't load display object: ".concat(e.url)))}):R({url:"".concat(a.display_base).concat(t,"/").concat(e,"/displayObj.json"),callback:window[r]}).on("error",e=>l(te("Couldn't load display list: ".concat(e.target.responseURL))))};var oe=a(9);const le=e=>e._displayList,re=e=>e.selectedDisplay&&""!==e.selectedDisplay.name&&e._displayInfo[e.selectedDisplay.name]?e._displayInfo[e.selectedDisplay.name]:{isFetching:!0,isLoaded:!1,didInvalidate:!1,info:{}},se=e=>e.selectedDisplay,ce=e=>e._cogDataMutable,de=e=>e.layout.pageNum?e.layout.pageNum:-1,pe=e=>e.layout.nrow*e.layout.ncol,he=e=>e.filter.state,me=e=>e.filter.view,ge=e=>e.sort,ue=e=>e.layout,be=e=>e.labels,fe=e=>e._config.config,ve=e=>e.appId,ye=e=>e.singlePageApp,Ee=e=>e.fullscreen,we=e=>e.dialog,xe=Object(oe.a)(re,e=>e.isLoaded?e.info.height/e.info.width:0),Se=Object(oe.a)(ce,he,me,re,(e,t,a,n)=>{const i={};if(e.iface&&a.active&&e.crossfilter&&"JSON"===e.iface.type){const o=a.active;for(let a=0;a<o.length;a+=1)if("factor"===n.info.cogInfo[o[a]].type){const n=t[o[a]]&&t[o[a]].orderValue?t[o[a]].orderValue:"ct,desc";let l=[];e.groupRefs[o[a]]&&(l="ct"===n.substr(0,2)?e.groupRefs[o[a]].top(1/0):e.groupRefs[o[a]].all());const r=["ct,asc","id,desc"].indexOf(n)<0;let s=0;for(let e=0;e<l.length;e+=1)l[e].value>s&&(s=l[e].value);const c=[],d=[],p=t[o[a]]&&t[o[a]].value?t[o[a]].value:[];let h=0;for(let e=0;e<l.length;e+=1){p.indexOf(l[e].key)<0?d.push(e):(c.push(e),h+=l[e].value)}i[o[a]]={dist:l,max:s,orderValue:n,reverseRows:r,totSelected:c.length,sumSelected:h,idx:c.concat(d)}}else if("numeric"===n.info.cogInfo[o[a]].type){const t=e.groupRefs[o[a]].all();let l=0;for(let e=0;e<t.length;e+=1)t[e].value>l&&(l=t[e].value);i[o[a]]={dist:t,max:l,breaks:n.info.cogInfo[o[a]].breaks,delta:n.info.cogInfo[o[a]].delta,range:n.info.cogInfo[o[a]].range,log:n.info.cogInfo[o[a]].log}}}return i}),_e=Object(oe.a)(ce,de,pe,he,ge,(e,t,a,n,i)=>{let o=[];return e.dimensionRefs&&e.dimensionRefs.__sort&&n&&i&&(o=1===i.length?"asc"===i[0].dir?e.dimensionRefs.__sort.bottom(a,(t-1)*a):e.dimensionRefs.__sort.top(a,(t-1)*a):e.dimensionRefs.__sort.bottom(a,(t-1)*a)),o}),Oe=Object(oe.a)(ce,he,(e,t)=>void 0===e.allRef&&t?0:e.allRef.value());var Ce=e=>{const t=Object.keys(e);return a=>a=>n=>(-1!==t.indexOf(n.type)&&e[n.type](),a(n))};const ke=(e,t)=>Number.isNaN(e[t]||void 0===e[t])?-9007199254740992:e[t],Ie=(e,t,a)=>{const n="asc"===a?1:0;return Number.isNaN(e[t])||void 0===e[t]?9007199254740992*n:e[t]},Ne=(e,t)=>e[t]?e[t]:"NA",De=e=>{let t=1,a=e;return"!"===e[0]&&(t=-1,a=a.substr(1)),(e,n)=>(e[a]<n[a]?-1:e[a]>n[a]?1:0)*t};var je=e=>t=>a=>{if("SET_FILTER"===a.type&&a.filter){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs,i=e.getState()._cogDataMutable.groupRefs;if("string"===typeof a.filter||a.filter instanceof String)n[a.filter].filter(null);else{const o=Object.keys(a.filter);0===o.length&&n&&Object.keys(e.getState().filter.state).forEach(e=>n[e].filter(null));for(let l=0;l<o.length;l+=1)if("numeric"===a.filter[o[l]].varType){if(void 0===n[o[l]]&&(n[o[l]]=t.dimension(e=>ke(e,o[l]))),void 0===i[o[l]]){const t=e.getState().selectedDisplay.name,a=e.getState()._displayInfo[t].info.cogInfo[o[l]];i[o[l]]=n[o[l]].group(e=>Number.isNaN(e)||void 0===e?null:a.breaks[Math.floor((e-a.breaks[0])/a.delta)])}if(void 0===a.filter[o[l]].value)n[o[l]].filter(null);else{let e=a.filter[o[l]].value.from,t=a.filter[o[l]].value.to;e=void 0===e?-1/0:e,t=void 0===t?1/0:t,n[o[l]].filterFunction(a=>a>=e&&a<=t)}}else if("factor"===a.filter[o[l]].varType)if(void 0===n[o[l]]&&(n[o[l]]=t.dimension(e=>Ne(e,o[l]))),void 0===i[o[l]]&&(i[o[l]]=n[o[l]].group()),void 0===a.filter[o[l]].value)n[o[l]].filter(null);else{const e=a.filter[o[l]].value;n[o[l]].filter(t=>e.indexOf(t)>-1)}}}else if("SET_FILTER_VIEW"===a.type){if("add"===a.which||"set"===a.which){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs,i=e.getState()._cogDataMutable.groupRefs,o=e.getState().selectedDisplay.name;let l=[];"add"===a.which?l.push(a.name):l=a.name.active,l.forEach(a=>{const l=e.getState()._displayInfo[o].info.cogInfo[a].type;if(void 0===n[a]&&(n[a]="numeric"===l?t.dimension(e=>ke(e,a)):t.dimension(e=>Ne(e,a))),void 0===i[a])if("numeric"===l){const t=e.getState()._displayInfo[o].info.cogInfo[a];i[a]=n[a].group(e=>Number.isNaN(e)||void 0===e?null:t.breaks[Math.floor((e-t.breaks[0])/t.delta)])}else i[a]=n[a].group()})}}else if("SET_SORT"===a.type&&void 0!==a.sort){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs;if(n){n.__sort&&n.__sort.remove();let i=a.sort;if("number"===typeof a.sort&&(i=Object.assign([],[],e.getState().sort),i.splice(a.sort,1)),0===i.length)n.__sort=t.dimension(e=>e.__index);else if(1===i.length){const a=e.getState().selectedDisplay.name,o=e.getState()._displayInfo[a].info.cogInfo[i[0].name];"factor"===o.type?n.__sort=t.dimension(e=>Ne(e,i[0].name)):"numeric"===o.type&&(n.__sort=t.dimension(e=>Ie(e,i[0].name,i[0].dir)))}else{const a=t.all(),o=[];for(let t=0;t<a.length;t+=1){const n={__index:a[t].__index};for(let o=0;o<i.length;o+=1){const l=e.getState().selectedDisplay.name,r=e.getState()._displayInfo[l].info.cogInfo[i[o].name];"factor"===r.type?n[i[o].name]=Ne(a[t],i[o].name):"numeric"===r.type&&(n[i[o].name]=Ie(a[t],i[o].name,i[o].dir))}o.push(n)}const l=[];for(let e=0;e<i.length;e+=1)l.push("".concat("asc"===i[e].dir?"":"!").concat(i[e].name));o.sort((e=>{const t=e;return(e,a)=>{let n=0,i=0;for(;0===i&&n<t.length;)i=De(t[n])(e,a),n+=1;return i}})(l));const r={};for(let e=0;e<o.length;e+=1)r[o[e].__index]=e;n.__sort=t.dimension(e=>r[e.__index])}}}return t(a)},Te=a(8);var Le=(e={active:""},t)=>{switch(t.type){case"ACTIVE_SIDEBAR":return Object(Te.a)(Object(Te.a)({},e),{},{active:t.active===e.active?"":t.active})}return e};const Re="object"===typeof window?window.innerHeight:null,Ae="object"===typeof window?window.innerWidth:null;var ze=(e={windowHeight:Re,windowWidth:Ae,origHeight:void 0,origWidth:void 0},t)=>{switch(t.type){case"WINDOW_RESIZE":return Object(Te.a)(Object(Te.a)({},e),{},{windowHeight:t.dims.height,windowWidth:t.dims.width});case"UPDATE_DIMS":return Object(Te.a)(Object(Te.a)({},e),{},{origHeight:t.dims.height,origWidth:t.dims.width})}return e};var Pe=(e={},t)=>{switch(t.type){case"SET_PANEL_RENDERER":return Object(Te.a)(Object(Te.a)({},e),{},{[t.name]:{fn:t.fn}})}return e},Fe=a(135),We=a.n(Fe);const Be=Object(s.c)({state:(e={},t)=>{switch(t.type){case"SET_FILTER":return"string"===typeof t.filter||t.filter instanceof String?We()(e,t.filter):void 0===t.filter||0===Object.keys(t.filter).length&&t.filter.constructor===Object?{}:Object(Te.a)(Object(Te.a)({},e),t.filter)}return e},view:(e={active:[],inactive:[]},t)=>{switch(t.type){case"SET_FILTER_VIEW":{let a=Object(Te.a)({},e);if(void 0===a.active&&(a.active=[]),void 0===a.inactive&&(a.inactive=[]),"remove"===t.which){const e=a.active.indexOf(t.name);e>-1&&a.active.splice(e,1);a.inactive.indexOf(t.name)<0&&a.inactive.push(t.name)}else if("add"===t.which){const e=a.inactive.indexOf(t.name);e>-1&&a.inactive.splice(e,1);a.active.indexOf(t.name)<0&&a.active.push(t.name)}else"set"===t.which&&(a=t.name);return a}}return e}});var He=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1,config:{}},t)=>{switch(t.type){case"REQUEST_CONFIG":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_CONFIG":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,config:t.config,lastUpdated:t.receivedAt});default:return e}};var Ve=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1,list:[]},t)=>{switch(t.type){case"REQUEST_DISPLAY_LIST":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_DISPLAY_LIST":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,list:t.list,lastUpdated:t.receivedAt});default:return e}};var Me=(e={},t)=>{switch(t.type){case"REQUEST_DISPLAY":return Object(Te.a)(Object(Te.a)({},e),{},{[t.name]:{isFetching:!0,isLoaded:!1,info:{},didInvalidate:!1}});case"RECEIVE_DISPLAY":return Object(Te.a)(Object(Te.a)({},e),{},{[t.name]:{isFetching:!1,didInvalidate:!1,isLoaded:!0,info:t.info,lastUpdated:t.receivedAt}});default:return e}};var Ue=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1},t)=>{switch(t.type){case"REQUEST_COGDATA":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_COGDATA":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,crossfilter:t.crossfilter,dimensionRefs:{},groupRefs:{},allRef:void 0!==t.crossfilter?t.crossfilter.groupAll():void 0,iface:t.iface,lastUpdated:t.receivedAt});default:return e}};var Ge=(e={},t)=>{switch(t.type){case"SET_LOCAL_PANELS":return Object(Te.a)(Object(Te.a)({},e),t.dat)}return e};var Ke=Object(s.c)({appId:(e="app",t)=>{switch(t.type){case"SET_APP_ID":return t.id}return e},staticView:(e="",t)=>{switch(t.type){case"SET_STATIC_VIEW":return t.val}return e},dialog:(e=!1,t)=>{switch(t.type){case"SET_DIALOG_OPEN":return t.isOpen}return e},dispSelectDialog:(e=!1,t)=>{switch(t.type){case"SET_DISPSELECT_DIALOG_OPEN":return t.isOpen}return e},dispInfoDialog:(e=!1,t)=>{switch(t.type){case"SET_DISPINFO_DIALOG_OPEN":return t.isOpen}return e},singlePageApp:(e=!0,t)=>{switch(t.type){case"SET_SINGLE_PAGE_APP":return t.singlePageApp}return e},fullscreen:(e=!0,t)=>{switch(t.type){case"SET_FULLSCREEN":return t.fullscreen}return e},ui:ze,sidebar:Le,errorMsg:(e="",t)=>{switch(t.type){case"SET_ERROR_MESSAGE":return t.msg}return e},selectedDisplay:(e={name:"",group:"",desc:""},t)=>{switch(t.type){case"SELECT_DISPLAY":return Object(Te.a)(Object(Te.a)({},e),{},{name:t.name,group:t.group,desc:t.desc})}return e},selectedRelDisps:(e=[],t)=>{switch(t.type){case"SET_SELECTED_RELDISPS":{const a=Object.assign([],e);if("add"===t.which)a.indexOf(t.val)<0&&a.push(t.val);else if("remove"===t.which){const e=a.indexOf(t.val);e>-1&&a.splice(e,1)}else{if("reset"===t.which)return[];if("set"===t.which)return t.val}return a.sort(),a}}return e},relDispPositions:(e=[],t)=>{switch(t.type){case"SET_REL_DISP_POSITIONS":return Object.assign([],[],t.obj)}return e},panelRenderers:Pe,layout:(e={nrow:1,ncol:1,arrange:"row",pageNum:1},t)=>{switch(t.type){case"SET_LAYOUT":{const a=Object(Te.a)({},t.layout);if(a.nrow||a.ncol){const t=e.nrow*e.ncol*(e.pageNum-1)+1;a.pageNum=Math.ceil(t/(a.nrow*a.ncol)),Number.isNaN(a.pageNum)&&(a.pageNum=1)}return Object(Te.a)(Object(Te.a)({},e),a)}}return e},labels:(e=[],t)=>{switch(t.type){case"SET_LABELS":return Object.assign([],[],t.labels)}return e},sort:(e=[],t)=>{switch(t.type){case"SET_SORT":if("number"===typeof t.sort){const a=Object.assign([],[],e);return a.splice(t.sort,1),a}return void 0===t.sort?[]:Object.assign([],[],t.sort)}return e},filter:Be,_config:He,_displayList:Ve,_displayInfo:Me,_cogDataMutable:Ue,_localPanels:Ge}),Ye=a(12),qe=a(221),Qe=a(142),Je=a.n(Qe),$e=a(11),Xe=a.n($e),Ze=a(136),et=a.n(Ze),tt=a(284),at=a(314),nt=a(285),it=a(286),ot=a(287);var lt={fontFamily:'"Open Sans", sans-serif',header:{height:48,fontSize:16,borderColor:"#eaedf0",background:"white",color:"#000",button:{color:"#9ba3af",active:{background:"#448AFF"}},logo:{background:"#FF4308",color:"white"},logoWidth:130},footer:{height:30,background:"#666666",color:"white",button:{background:"#90CAF9",color:"white"}},sideButtons:{width:48,fontSize:22,labelFontSize:11,background:"#b3b3b3",spacerBackground:"#c1c1c1",button:{color:"white",borderColor:"#c0c0c0",active:{color:"#448AFF",background:"white"},hover:{background:"#448AFF"}}},sidebar:{width:230,borderColor:"#c1c1c1",header:{fontSize:15,height:25,background:"#c1c1c1",color:"white"},filter:{margin:5,cat:{height:125,bar:{height:15,color:{default:"#eee",hover:"rgb(255, 192, 76)",select:"rgb(255, 170, 10)",noneSelect:"rgb(255, 210, 127)"}},text:{color:{default:"#888",hover:"#000",select:"#000"}}},num:{height:100,barColor:"rgb(255, 210, 127)"},variables:{height:50}}},content:{panel:{pad:2},label:{height:15,fontSize:12}},trans:{duration:"300ms",timing:"ease"}};const rt={passoverHTML:!1,passoverAttribute:"passover",stripPassoverAttribute:!0};class st extends i.a.Component{constructor(...e){super(...e),this.handleOpen=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!0),a(!0),Xe.a.bind("esc",this.handleClose)},this.handleKey=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!0),a(!0),Xe.a.bind("esc",this.handleClose)},this.handleClose=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!1),a(!1),Xe.a.unbind("esc")}}componentDidMount(){const e=this.props,t=e.active,a=e.fullscreen;t&&a&&Xe.a.bind("i",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.active&&e.fullscreen?Xe.a.bind("i",this.handleKey):Xe.a.unbind("i")}componentWillUnmount(){const e=this.props,t=e.active,a=e.fullscreen;t&&a&&Xe.a.unbind("i")}render(){const e=this.props,t=e.classes,a=e.curDisplayInfo,n=e.singleDisplay,o=e.styles;let l="";if(a.isLoaded){const e=et()(a.info.mdDesc,rt);let n="";a.info.desc&&(n=i.a.createElement("em",null,a.info.desc));const o=i.a.createElement("div",null,i.a.createElement("div",{style:{background:"#ededed",padding:5}},i.a.createElement("strong",null,a.info.name),i.a.createElement("br",null),n),i.a.createElement("p",null,"This visualization contains ".concat(a.info.n,' "panels" that you can interactively view through various controls. Each panel has a set of variables or metrics, called "cognostics", that you can use to sort and filter the panels that you want to view.')),i.a.createElement("p",null,"To learn more about how to interact with this visualization, click the \u201c?\u201d icon in the top right corner of the display."),a.info.has_inputs&&i.a.createElement("p",null,"There are user input variables available in this visualization with which you can provide feedback for any panel. These will show up as either a radio button or free text entry in the labels that show up under each panel. As you enter inputs, these are saved in your local web browser's storage and will be remembered in subsequent views of the display."),a.info.has_inputs&&i.a.createElement("p",null,"If you'd like to pull the data that you have input, you can click the \u201cExport Inputs\u201d button at the bottom left corner of the display and follow the prompts in the dialog box that pops up.")),r=this.props.isOpen;l=i.a.createElement(at.a,{open:r,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-info-title",onBackdropClick:this.handleClose,disableEscapeKeyDown:!0,maxWidth:"md"},i.a.createElement(tt.a,{id:"dialog-info-title"},"".concat(a.info.mdTitle)),i.a.createElement(nt.a,null,i.a.createElement("div",{className:t.modalContainer},o,i.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}}))),i.a.createElement(it.a,null,i.a.createElement(ot.a,{color:"secondary",onClick:this.handleClose},"Close")))}return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.button,style:n?o.single:o.button},i.a.createElement("i",{className:"".concat(t.icon," icon-info_outline")})),l)}}const ct={button:{position:"absolute",boxSizing:"border-box",top:-1,display:"inline-block",height:lt.header.height,width:lt.header.height-1,fontSize:18,paddingTop:0,color:lt.header.button.color,background:"none",textAlign:"center",borderRight:"1px solid ".concat(lt.header.borderColor),borderBottom:"1px solid ".concat(lt.header.borderColor),borderTop:"none",borderLeft:"none","&:hover":{transition:"background 250ms",background:"#eee",cursor:"pointer"}},icon:{paddingLeft:2,lineHeight:"".concat(lt.header.height,"px")},modalContainer:{overflowY:"auto",maxHeight:520}},dt=Object(oe.a)(se,re,Ee,e=>e.dispInfoDialog,(e,t,a,n)=>({styles:{button:{left:""===e.name?-lt.sideButtons.width:lt.sideButtons.width},single:{left:""===e.name?-lt.sideButtons.width:0}},curDisplayInfo:t,fullscreen:a,active:""!==e.name,isOpen:n}));var pt=Object(r.b)(e=>dt(e),e=>({setThisDialogOpen:t=>{e(H(t))}}))(Object(Ye.a)(ct)(st)),ht=a(316),mt=a(293),gt=a(294),ut=a(292),bt=a(95),ft=a.n(bt),vt=a(96),yt=a.n(vt),Et=a(160),wt=a(290),xt=a(288),St=a(291),_t=a(289),Ot=a(312),Ct=a(138),kt=a.n(Ct);const It=Object(oe.a)(re,le,(e,t)=>{const a={};if(e.isLoaded){const n=e.info.keySig,i=[e.info.group,e.info.name].join("/");t.list.forEach((e,t)=>{const o=e.keySig===n,l=[e.group,e.name].join("/");o&&l!==i&&(a[e.group]||(a[e.group]=[]),a[e.group].push(t))})}return a}),Nt=e=>e.selectedRelDisps,Dt=(Object(oe.a)(re,le,Nt,(e,t,a)=>{const n=[];return t.isLoaded&&e.isLoaded&&n.push({aspect:e.info.height/e.info.width,group:e.info.group,name:e.info.name}),a.forEach(e=>{n.push({aspect:t.list[e].height/t.list[e].width,group:t.list[e].group,name:t.list[e].name})}),n}),Object(oe.a)(re,e=>e.info.cogInfo?e.info.cogInfo:{})),jt=Object(oe.a)(le,e=>{const t={};if(e.list)for(let a=0;a<e.list.length;a+=1)t[e.list[a].group]||(t[e.list[a].group]=[]),t[e.list[a].group].push(a);return t}),Tt=e=>e.ui.windowWidth,Lt=e=>e.ui.windowHeight,Rt=e=>e.sidebar.active,At=Object(oe.a)(Lt,e=>e-lt.header.height-lt.footer.height-lt.sidebar.header.height),zt=Object(oe.a)(me,re,At,(e,t,a)=>{const n=e.active;if(void 0===n)return{cutoff:null,heights:[0,0]};const i=n.map(e=>{if(!t.isLoaded)return 0;if("factor"===t.info.cogInfo[e].type){const a=t.info.cogInfo[e].levels?t.info.cogInfo[e].levels.length:1e3;return Math.min(lt.sidebar.filter.cat.height,15*a)+54}return"numeric"===t.info.cogInfo[e].type?lt.sidebar.filter.num.height+54:0});let o=null,l=0,r=0;for(let s=0;s<i.length;s+=1)null===o?l+i[s]>a?(o=s,r+=i[s]):l+=i[s]:r+=i[s];return null===o&&l+30+lt.sidebar.filter.variables.height>a&&(o=i.length),{cutoff:o,heights:[l,r]}}),Pt=Object(oe.a)(Tt,Rt,zt,(e,t,a)=>{const n=lt.sidebar.width*(1+("Filter Panels"===t&&a&&null!==a.cutoff));return e-lt.sideButtons.width-(""===t?0:n+1)}),Ft=Object(oe.a)(Lt,e=>e-lt.header.height-lt.footer.height),Wt={container:{height:400,overflowY:"auto"},groupContainer:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},gridList:{width:700,marginBottom:24},gridTile:{cursor:"pointer"},gridTitle:{fontWeight:400,color:kt.a.A200,fontSize:15},gridSubtitle:{fontStyle:"italic",fontSize:11},img:{opacity:1,"&:hover":{opacity:.7}},titleBar:{background:"rgba(0, 0, 0, 0.8) !important"},checkbox:{position:"absolute !important",left:0,top:0,background:"rgba(69, 138, 249, 0.9) !important",color:"white !important","&checked":{color:"white !important"}},disclaimer:{paddingLeft:10,fontSize:13,marginTop:-3}},Bt=Object(oe.a)(se,Nt,fe,ve,Ft,Pt,(e,t,a,n,i,o)=>({selectedDisplay:e,selectedRelDisps:t,appId:n,cfg:a,contentHeight:i,contentWidth:o}));var Ht=Object(r.b)(e=>Bt(e),e=>({handleCheckbox:(t,a,n,i,o,l,r,s)=>{const c=a.indexOf(t)>-1,d=Object.assign([],a);if(c){const e=d.indexOf(t);e>-1&&d.splice(e,1)}else d.indexOf(t)<0&&(e(ie(i[t].name,i[t].group,r,s,"",!1)),d.push(t));d.sort();const p=((e,t,a,n,i)=>{const o=[a.map(e=>e.name).indexOf(e.name),...t],l=o.length,r=n/i,s=[];for(let v=1;v<=l;v+=1)l/v===Math.floor(l/v)&&s.push([v,l/v]);const c=[],d=i*n;s.forEach((e,t)=>{const l=e[0],s=e[1],p=e[1]/e[0]*r,h=i/s,m=n/l;let g=0;for(let n=0;n<l*s;n+=1){const e=a[o[n]].height/a[o[n]].width;let t=h,i=t*e;p<e&&(i=m,t=i/e),g+=t*i}c[t]=d-g});const p=s[c.indexOf(Math.min.apply(null,c))],h=p[0],m=p[1],g=p[1]/p[0]*r,u=i/n/m,b=1/h,f=o.map((e,t)=>{const n=Math.floor(t/m),i=t%m,o=a[e].height/a[e].width;let l=u,r=l*o;return g<o&&(r=b,l=r/o),{idx:e,name:a[e].name,group:a[e].group,aspect:o,left:i*u,top:n*b,width:l,height:r,row:n,col:i}});return 1===f.length&&f[0].name===e.name?[]:f})(n,d,i,o,l);e(V({nrow:1,ncol:1})),e(Q(d)),e(J(p))}}))(Object(Ye.a)(Wt)(({classes:e,selectable:t,di:a,displayGroups:n,handleClick:o,cfg:l,appId:r,selectedDisplay:s,selectedRelDisps:c,handleCheckbox:d,contentHeight:p,contentWidth:h})=>{const m=Object.keys(n),g=m.map(g=>{return i.a.createElement("div",{className:e.groupContainer,key:g},i.a.createElement(wt.a,{cellHeight:180,cols:3,className:e.gridList},(u=g,m.length>1?i.a.createElement(xt.a,{key:"Subheader",cols:3,style:{height:"auto"}},i.a.createElement(_t.a,{style:{fontSize:20,color:"black"},component:"div"},u)):null),n[g].map(n=>i.a.createElement(xt.a,{key:n,className:e.gridTile,onClick:()=>{t?d(n,c,s,a,p,h,l,r):o(a[n].name,a[n].group,a[n].desc)}},i.a.createElement("img",{src:"".concat(l.cog_server.info.base,"/").concat(a[n].group,"/").concat(a[n].name,"/thumb.png"),alt:a[n].name,className:e.img,key:"img".concat(n)}),t&&i.a.createElement(Ot.a,{classes:{root:e.checkbox},checked:c.indexOf(n)>-1,onChange:()=>{d(n,c,s,a,p,h,l,r)},value:"checked".concat(n),inputProps:{}}),i.a.createElement(St.a,{classes:{root:e.titleBar},title:i.a.createElement("div",{className:e.gridTitle},a[n].name.replace(/_/g," ")),subtitle:i.a.createElement("span",{style:{fontSize:13}},a[n].desc,i.a.createElement("br",null),i.a.createElement("span",{className:e.gridSubtitle},a[n].n,"\xa0panels,",a[n].updated.substring(0,a[n].updated.length-3)))}))),l.disclaimer?i.a.createElement(xt.a,{cols:l.disclaimer.cols},i.a.createElement("div",{className:e.disclaimer,dangerouslySetInnerHTML:{__html:l.disclaimer.text}})):""));var u});return i.a.createElement("div",{className:e.container},g)}));const Vt={display:"flex",alignItems:"center",justifyContent:"center",border:"solid 1px #ddd",background:"rgba(69, 138, 249, 0.4)"},Mt=e=>parseInt(e.replace("px",""),10);class Ut extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Xe.a.bind("esc",this.handleClose)},this.handleKey=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Xe.a.bind("esc",this.handleClose)},this.handleClose=()=>{(0,this.props.setDialogOpen)(!1),this.setState({open:!1}),Xe.a.unbind("esc")},this.setStep=e=>{this.setState({activeStep:e})},this.handleNext=()=>{this.setState({activeStep:1})},this.handleBack=()=>{this.setState({activeStep:0})},this.state={open:!1,activeStep:0}}componentDidMount(){this.props.active&&Xe.a.bind("r",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.active?Xe.a.bind("r",this.handleKey):Xe.a.unbind("r")}componentWillUnmount(){this.props.active&&Xe.a.unbind("r")}render(){const e=this.props,t=e.classes,a=e.styles,n=e.relatedDisplayGroups,o=e.displayList,l=e.contentHeight,r=e.contentWidth,s=e.selectedRelDisps,c=e.relDispPositions,d=e.handleResize,p=this.state,h=p.open,m=p.activeStep,g={position:"relative",background:"#efefef",width:r/l*400,height:400,marginLeft:"auto",marginRight:"auto"},u=[i.a.createElement(Ht,{di:o.list,displayGroups:n,handleClick:()=>{},selectable:!0}),i.a.createElement("div",{style:g},c.map(e=>i.a.createElement(Et.a,{key:e.name,style:Vt,default:{width:400*e.width,height:400*e.height,x:400*e.left,y:400*e.top},bounds:"parent",lockAspectRatio:!0,onDragStop:(t,a)=>{d(e,c,a.x,a.y,void 0,void 0,400)},onResizeStop:(t,a,n,i,o)=>{d(e,c,o.x,o.y,Mt(n.style.width),Mt(n.style.height),400)}},i.a.createElement("div",{className:t.trHandle}),i.a.createElement("div",{className:t.tlHandle}),i.a.createElement("div",{className:t.brHandle}),i.a.createElement("div",{className:t.blHandle}),e.name)))];return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.button,style:a.button},i.a.createElement("i",{className:"icon-open-add",style:{paddingLeft:2,lineHeight:"45px"}},i.a.createElement(ut.a,{className:t.badge,classes:{badge:t.badgeCircle},badgeContent:s.length}))),i.a.createElement(at.a,{open:h,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},onBackdropClick:this.handleClose,"aria-labelledby":"dialog-reldisp-title",maxWidth:"md",fullWidth:!0},i.a.createElement(tt.a,{id:"dialog-reldisp-title"},"View Related Displays Simultaneously"),i.a.createElement(nt.a,null,i.a.createElement("div",null,i.a.createElement(ht.a,{alternativeLabel:!0,nonLinear:!0,activeStep:m},i.a.createElement(mt.a,null,i.a.createElement(gt.a,{onClick:()=>this.setStep(0)},"Select related displays (".concat(s.length," selected)"))),i.a.createElement(mt.a,null,i.a.createElement(gt.a,{onClick:()=>this.setStep(1),disabled:0===m&&0===s.length},"Arrange Panel Layout"))),i.a.createElement("div",null,u[m]))),i.a.createElement(it.a,null,i.a.createElement("div",{style:{textAlign:"center",width:"100%"}},i.a.createElement(ot.a,{style:{width:200},onClick:()=>this.setStep(1===m?0:1),className:t.button,disabled:0===m&&0===s.length},0===m?"":i.a.createElement(ft.a,null),0===m?"Set Layout":"Select Displays",0===m?i.a.createElement(yt.a,null):"")),i.a.createElement(ot.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const Gt={button:{position:"absolute",boxSizing:"border-box",top:-1,transition:"left 0.5s ease, background 250ms",display:"inline-block",height:lt.header.height,width:lt.header.height,fontSize:18,textAlign:"center",borderRight:"1px solid ".concat(lt.header.borderColor),borderBottom:"1px solid ".concat(lt.header.borderColor),borderLeft:"none",borderTop:"none","&:hover":{transition:"background 250ms",background:"#eee",cursor:"pointer"}},trHandle:{position:"absolute",top:0,right:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},tlHandle:{position:"absolute",top:0,left:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},brHandle:{position:"absolute",bottom:0,right:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},blHandle:{position:"absolute",bottom:0,left:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},badge:{paddingBottom:27},badgeCircle:{background:"rgba(69, 138, 249, 0.4)",color:"white"}},Kt=Object(oe.a)(le,se,It,Ft,Pt,Nt,e=>e.relDispPositions,(e,t,a,n,i,o,l)=>({styles:{button:{left:lt.header.height*(""===t.name||0===Object.keys(a).length?0:2)-1,background:0===o.length?"none":"rgba(69, 138, 249, 0.4)",color:0===o.length?lt.header.button.color:"white"}},displayList:e,relatedDisplayGroups:a,active:Object.keys(a).length>0,contentHeight:n,contentWidth:i,selectedRelDisps:o,relDispPositions:l}));var Yt=Object(r.b)(e=>Kt(e),e=>({handleResize:(t,a,n,i,o,l,r)=>{const s=a.map(e=>e.name).indexOf(t.name),c=Object(Te.a)({},t);c.left=n/r,c.top=i/r,o&&(c.width=o/r),l&&(c.height=l/r);const d=Object(Te.a)({},a);d[s]=c,e(J(d))}}))(Object(Ye.a)(Gt)(Ut)),qt=a(32),Qt=a.n(qt),Jt=a(33);class $t extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{const e=this.props,t=e.displayList,a=e.setDialogOpen,n=e.setDispDialogOpen;t&&t.isLoaded&&(a(!0),n(!0),Xe.a.bind("esc",this.handleClose))},this.handleKey=()=>{const e=this.props,t=e.setDialogOpen,a=e.setDispDialogOpen;t(!0),a(!0),Xe.a.bind("esc",this.handleClose)},this.handleClose=()=>{const e=this.props,t=e.setDialogOpen,a=e.setDispDialogOpen;t(!1),a(!1),Xe.a.unbind("esc")},this.handleSelect=(e,t,a)=>{const n=this.props,i=n.handleClick,o=n.setDialogOpen,l=n.setDispDialogOpen;i(e,t,a,n.cfg,n.appId),o(!1),l(!1)},this.state={btnScale:1}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.selectedDisplay,n=this.state.btnScale;t&&Xe.a.bind("o",this.handleKey);const i=setInterval(()=>{const e=this._atnnCircle;""!==a.name&&clearInterval(i),e&&(e.style.transform="scale(".concat(n,")"),this.setState({btnScale:1===n?.85:1}))},750)}UNSAFE_componentWillReceiveProps(e){e.fullscreen?Xe.a.bind("o",this.handleKey):Xe.a.unbind("o")}componentWillUnmount(){this.props.fullscreen&&Xe.a.unbind("o")}render(){const e=this.props,t=e.classes,a=e.displayList,n=e.displayGroups,o=e.selectedDisplay,l=e.isOpen,r=a&&a.isLoaded;let s=i.a.createElement("div",{className:t.attnOuter},i.a.createElement("div",{className:t.attnInner},i.a.createElement("div",{ref:e=>{this._atnnCircle=e},className:t.attnEmpty})));return(""!==o.name||l)&&(s=""),i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:Qt()({[t.button]:!0,[t.buttonInactive]:!r})},s,i.a.createElement("i",{className:"icon-folder-open ".concat(t.folderIcon)})),i.a.createElement(at.a,{open:l,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-dispselect-title",onBackdropClick:this.handleClose,disableEscapeKeyDown:!0,maxWidth:"md",fullWidth:!0},i.a.createElement(tt.a,{id:"dialog-dispselect-title"},"Select a Display to Open"),i.a.createElement(nt.a,null,i.a.createElement(Ht,{di:a.list,displayGroups:n,handleClick:this.handleSelect,selectable:!1})),i.a.createElement(it.a,null,i.a.createElement(ot.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const Xt={attnOuter:{position:"absolute",overflow:"hidden",height:lt.header.height,width:lt.header.height,top:0,left:(lt.sideButtons.width-lt.header.height)/2,pointerEvents:"none"},attnInner:{position:"absolute",height:lt.header.height,width:lt.header.height,top:0,left:0,transition:["transform 450ms cubic-bezier(0.23, 1, 0.32, 1)","0ms opacity 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms"].join(" "),opacity:1,transform:"scale(0.85)"},attnEmpty:{position:"absolute",height:lt.header.height,width:"100%",borderRadius:"50%",opacity:.16,transition:"transform 750ms cubic-bezier(0.445, 0.05, 0.55, 0.95) 0ms",top:0,transform:"scale(0.85)",backgroundColor:"rgba(0, 0, 0, 0.870588)"},folderIcon:{paddingLeft:3},button:{zIndex:8e3,position:"absolute",boxSizing:"border-box",top:-1,left:-1,height:lt.header.height,width:lt.sideButtons.width,fontSize:18,lineHeight:"".concat(lt.header.height+2,"px"),background:lt.header.button.active.background,color:"white",textAlign:"center",border:"none",transition:"all 500ms ease-in","&:hover":{transition:"background 250ms",background:Object(Jt.emphasize)(lt.header.button.active.background,.2),color:"white",cursor:"pointer"}},buttonInactive:{background:"#ddd",borderColor:"#ddd","&:hover":{background:"#ccc",borderColor:"#ccc"}}},Zt=Object(oe.a)(se,le,jt,fe,ve,ye,Ee,e=>e.dispSelectDialog,(e,t,a,n,i,o,l,r)=>({appId:i,cfg:n,selectedDisplay:e,displayList:t,displayGroups:a,singlePageApp:o,fullscreen:l,isOpen:r}));var ea=Object(r.b)(e=>Zt(e),e=>({handleClick:(t,a,n,i,o)=>{var l;e(F("")),e({type:"SET_SELECTED_RELDISPS",which:"reset",val:l}),e(M([])),e(V({nrow:1,ncol:1,arrange:"row"})),e(V({pageNum:1})),e(K({active:[],inactive:[]})),e(G({})),e(U([])),e(J([])),e(q(t,a,n)),e(ie(t,a,i,o,""))},setDispDialogOpen:t=>{e(B(t))}}))(Object(Ye.a)(Xt)($t)),ta=a(139),aa=a.n(ta),na=a(140),ia=a.n(na);class oa extends i.a.Component{constructor(...e){super(...e),this.pageLeft=()=>{const e=this.props;let t=e.n-1;return t<1&&(t+=1),(0,e.handleChange)(t)},this.pageRight=()=>{const e=this.props;let t=e.n+1;return t>e.totPages&&(t-=1),(0,e.handleChange)(t)},this.pageFirst=()=>{(0,this.props.handleChange)(1)},this.pageLast=()=>{const e=this.props;(0,e.handleChange)(e.totPages)}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.dialogOpen;t&&(Xe.a.bind("right",()=>{a||this.pageRight()}),Xe.a.bind("left",()=>{a||this.pageLeft()}))}UNSAFE_componentWillReceiveProps(e){const t=e.dialogOpen;e.fullscreen?(Xe.a.bind("right",()=>{t||this.pageRight()}),Xe.a.bind("left",()=>{t||this.pageLeft()})):Xe.a.unbind(["right","left"])}componentWillUnmount(){this.props.fullscreen&&Xe.a.unbind(["right","left"])}render(){const e=this.props,t=e.classes,a=e.cogData,n=e.totPages,o=e.totPanels,l=e.npp,r=e.n,s={icon:{fontSize:10,padding:6},button:{width:lt.header.height-10,height:lt.header.height-10,border:0,padding:0},progress:{width:120,fontSize:14,color:"#444",lineHeight:"48px"}};if(a.isFetching||a.isLoaded&&void 0===a.crossfilter)return i.a.createElement("div",{style:s.progress},"loading panels...");if(0===o)return i.a.createElement("div",null);const c=l*(r-1)+1,d=Math.min(l*r,o);let p=i.a.createElement("span",null,c);c!==d&&(p=i.a.createElement("span",null,c,"\xa0",i.a.createElement("span",{className:t.pageDash},"-"),"\xa0",d));const h=i.a.createElement("span",null,p,i.a.createElement("span",null," of ".concat(o)));return i.a.createElement("div",{className:t.outer},i.a.createElement("div",{className:t.label},h),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(qe.a,{disabled:r<=1,style:s.button,onClick:()=>this.pageFirst()},i.a.createElement(aa.a,null))),i.a.createElement("div",{className:t.buttonText},"First")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(qe.a,{disabled:r<=1,style:s.button,onClick:()=>this.pageLeft()},i.a.createElement(ft.a,null))),i.a.createElement("div",{className:t.buttonText},"Prev")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(qe.a,{disabled:r>=n,style:s.button,onClick:()=>this.pageRight()},i.a.createElement(yt.a,null))),i.a.createElement("div",{className:t.buttonText},"Next")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(qe.a,{disabled:r>=n,style:s.button,onClick:()=>this.pageLast()},i.a.createElement(ia.a,null))),i.a.createElement("div",{className:t.buttonText},"Last")))}}const la={outer:{whiteSpace:"nowrap"},buttonWrap:{width:lt.header.height-10,height:lt.header.height,display:"inline-block"},buttonDiv:{width:lt.header.height-10,height:lt.header.height-10,paddingLeft:5},buttonText:{fontSize:10,width:48,height:10,lineHeight:"10px",textAlign:"center",marginTop:-5},pageDash:{display:"inline-block",transform:"scale(1.5,1)"},label:{verticalAlign:"middle",height:lt.header.height,display:"inline-block"}},ra=Object(oe.a)(de,Oe,pe,we,Ee,ce,(e,t,a,n,i,o)=>({n:e,totPanels:t,totPages:Math.ceil(t/a),npp:a,dialogOpen:n,fullscreen:i,cogData:o}));var sa=Object(r.b)(e=>ra(e),e=>({handleChange:t=>{e(V({pageNum:t}))}}))(Object(Ye.a)(la)(oa)),ca=a(309),da=a(295);class pa extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Xe.a.bind("esc",this.handleClose)},this.handleChange=(e,t)=>{this.setState({value:t})},this.handleKey=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Xe.a.bind("esc",this.handleClose)},this.handleClose=()=>{(0,this.props.setDialogOpen)(!1),this.setState({open:!1}),Xe.a.unbind("esc")},this.state={open:!1,value:0}}componentDidMount(){this.props.fullscreen&&Xe.a.bind("a",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.fullscreen?Xe.a.bind("a",this.handleKey):Xe.a.unbind("a")}componentWillUnmount(){this.props.fullscreen&&Xe.a.unbind("a")}render(){const e=this.props,t=e.classes,a=e.fullscreen,n=e.windowHeight;let o="";a||(o=i.a.createElement("p",{className:t.keynote},"Note: keyboard shortcuts are only available when the app is fullscreen."));const l=i.a.createElement("div",{className:t.dialogDiv,style:{maxHeight:Math.max(50,n-310)}},i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"What: "),"Trelliscope is a tool for interactively viewing a large collection of visualizations.  Each visualization in a collection is called a\xa0",i.a.createElement("em",null,"panel"),"\xa0and each panel typically represents one slice of a large dataset."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"Why: "),"Viewing multiple slices of a dataset simultaneously is a simple  but very powerful visual technique and provides a way to visualize data in greater detail, particularly when the dataset is large."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"Interactivity: "),"When there are many panels, it is useful to be able to navigate to which panels you want to view and make panel-to-panel comparisons by sorting and filtering the panels based on various criteria. Trelliscope provides this interactivity through panel metrics called\xa0",i.a.createElement("em",null,"cognostics"),"."),i.a.createElement("p",null,"There are multiple modes of interaction with panels, indicated by the four buttons on the left sidebar of the application: \xa0",i.a.createElement("strong",null,"Grid"),",\xa0",i.a.createElement("strong",null,"Labels"),",\xa0",i.a.createElement("strong",null,"Filter"),",\xa0and\xa0",i.a.createElement("strong",null,"Sort"),"."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-th ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Grid: "),'In the "Grid" sidebar, you can specify the layout of the grid of panels you wish to display, specifying the number of rows and columns of the grid, as well as whether to arrange panels in order by row or by column.'),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-list-ul ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Labels: "),'In the "Labels" sidebar, you can specify the panel metrics that you wish to see displayed under each panel visualization in the grid by clicking the checkboxes.  This can be useful for additional context along with the visualization being shown.  Note that labels can also be removed by directly hovering over the label in the grid view and clicking the "x" button that appears.  Labels are also automatically added when you specify a new variable to sort or filter on.'),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-filter ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Filter: "),'The "Filter" sidebar provides various ways to filter the panels being displayed based on the panel metrics. A list of variables is available as buttons.  Clicking a button will produce a visual distribution of the variable.',i.a.createElement("p",{className:t.dialogP2},i.a.createElement("strong",null,"Categorical filter: "),"For categorical variables, a bar chart is provided, showing the the possible values of the variable with the size of the bars relating to the count of panels available under the current filtering state of all other variables. A bar is active if its color is highlighted.  The bar chart shows active bars first followed by inactive bars. Clicking on a bar in this chart that is not active will cause only panels with the attribute of the clicked bar to be shown. Clicking on a bar that is active will remove panels with the attribute of the clicked bar from view.  Another way to specify filtering for categorical variables is to enter text into the text field below the bar chart.  Any matches to the typed text will be highlighted in the bar chart and panels will be filtered accordingly.  This field can be plain text or a\xa0",i.a.createElement("a",{href:"http://regexr.com/",target:"_blank",rel:"noopener noreferrer"},"regular expression"),"."),i.a.createElement("p",{className:t.dialogP2},i.a.createElement("strong",null,"Numeric filter: "),"For numeric variables, a histogram is provided, which shows the distribution of the variable based on all other active filters. You can click and drag left to right to highlight a range of the variable for which you would like to filter the panels. Alternatively, you can manually enter a range in the fields provided below the histogram."),i.a.createElement("p",{className:t.dialogP22},"To reset a filter variable, you can either clear out the fields, deselect the selections made in the distribution plots, or click the\xa0",i.a.createElement("i",{className:"icon-undo"}),"\xa0button located at the top right of the filter box for that variable.  This icon is only available if there is an active filter for the variable."),i.a.createElement("p",{className:t.dialogP22},"To close a filter box, click the\xa0",i.a.createElement("i",{className:"icon-times-circle"}),'\xa0button located at the top right of the filter box.  Note that if there is an active filter on the variable, its button in the "More variables" section will be green to indicate this.')),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-sort-amount-asc ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Sort: "),'In the "Sort" sidebar, a list of variables which are currently being sorted by (if any) will be listed at the top, followed by a list of "More variables" that can added to the sorting specification.  Panels are ordered primarily according to the topmost sort variable, and any subsuequent sorting variables specify secondary, tertiary, etc. sorting. For an active sortig variable, clicking the blue icon with an arrow pointing up or down will change the order of the sorting.'),i.a.createElement("div",{className:t.dialogP},"The active filter and sort state are displayed at the bottom of the page in the footer.  Clicking the\xa0",i.a.createElement("i",{className:"icon-times-circle"}),"\xa0button for anything listed in the footer will remove the sorting or filtering on that variable.")),r=i.a.createElement("div",{className:t.dialogDiv},i.a.createElement("div",null,o,i.a.createElement("div",{style:{width:"50%",display:"block",float:"left"}},i.a.createElement("h4",{className:t.dialogH4},"Sidebar controls"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"g"),'\u2002open "Grid" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"l"),'\u2002open "Labels" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"f"),'\u2002open "Filter" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"s"),'\u2002open "Sort" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"esc"),"\u2002close sidebar")),i.a.createElement("h4",{className:t.dialogH4},"Panel navigation"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"left"),"\u2002page back"),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"right"),"\u2002page forward"))),i.a.createElement("div",{style:{width:"50%",display:"block",float:"left"}},i.a.createElement("h4",{className:t.dialogH4},"Dialog boxes"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"i"),'\u2002open "Display Info" dialog'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"a"),'\u2002open "About" dialog'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"esc"),"\u2002close dialog")),i.a.createElement("h4",{className:t.dialogH4},"Touchscreen devices"),i.a.createElement("p",{className:t.dialogUl},"Swiping left and right will page the panels forward and backward")))),s=i.a.createElement("div",{className:t.dialogDiv},i.a.createElement("p",null,"\xa9\xa0",i.a.createElement("a",{href:"http://ryanhafen.com",target:"_blank",rel:"noopener noreferrer"},"Ryan Hafen"),", 2019."),i.a.createElement("p",null,"Built with\xa0",i.a.createElement("a",{href:"https://facebook.github.io/react/",target:"_blank",rel:"noopener noreferrer"},"React"),"\xa0and several other awesome libraries listed\xa0",i.a.createElement("a",{href:"https://github.com/hafen/trelliscopejs-lib/blob/master/package.json",target:"_blank",rel:"noopener noreferrer"},"here"),"."),i.a.createElement("p",null,"Source code available on\xa0",i.a.createElement("a",{href:"https://github.com/hafen/trelliscopejs-lib/",target:"_blank",rel:"noopener noreferrer"},"github"),"\xa0\u2013 submit issues and feature requests there."),i.a.createElement("p",null,"Thanks to Bill Cleveland for ideas upon which this is built, to Saptarshi Guha for creating a multi-panel plot viewer prototype many years ago that inspired initial work, and to Barret Schloerke for the introduction to React and discussions about the interface.")),c=this.state,d=c.open,p=c.value;return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.logo},"Trelliscope",i.a.createElement("div",{className:t.icon},i.a.createElement("i",{className:"icon-help ".concat(t.icon)}))),i.a.createElement(at.a,{open:d,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-viewer-title",onBackdropClick:this.handleClose},i.a.createElement(tt.a,{id:"dialog-viewer-title"},"Trelliscope Viewer v".concat("0.3.4")),i.a.createElement(nt.a,null,i.a.createElement(ca.a,{value:p,onChange:this.handleChange},i.a.createElement(da.a,{label:"How to Use"}),i.a.createElement(da.a,{label:"Shortcuts"}),i.a.createElement(da.a,{label:"Credits"})),0===p&&l,1===p&&r,2===p&&s),i.a.createElement(it.a,null,i.a.createElement(ot.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const ha={logo:{position:"absolute",top:-1,right:0,cursor:"pointer",border:"none",height:lt.header.height,textAlign:"center",width:lt.header.logoWidth,fontSize:17,background:lt.header.logo.background,color:lt.header.logo.color},icon:{position:"absolute",top:1,right:1,color:Object(Jt.emphasize)(lt.header.logo.background,.4)},dialogHeadline:{fontSize:24,paddingTop:16,marginBottom:12,fontWeight:400},dialogDiv:{fontSize:18,paddingLeft:10,paddingRight:10,zIndex:5e3},dialogH4:{marginBottom:5},dialogUl:{marginTop:0,breakInside:"avoid-column"},dialogCode:{color:"#FF5252",fontSize:20},dialogP:{textIndent:-20,paddingLeft:20,marginTop:"1em"},dialogP2:{paddingLeft:20},dialogP22:{textIndent:0,paddingLeft:20},dialogHi:{color:"#FF5252"},keynote:{marginBottom:0,color:"#888",fontStyle:"italic"}},ma=Object(oe.a)(Lt,Ee,(e,t)=>({windowHeight:e,fullscreen:t}));var ga=Object(r.b)(e=>ma(e))(Object(Ye.a)(ha)(pa)),ua=a(28),ba=a(297),fa=a(308),va=a(141),ya=a.n(va),Ea=a(296);const wa=Object(Ea.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"25ch"}},buttonContainer:{display:"flex",flexDirection:"row"},button:{flex:"1 0 auto"},link:{fontSize:24,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingLeft:15,paddingTop:5,fontFamily:'"Open Sans", sans-serif',fontWeight:200}}));function xa(e){const t=window.location.hash,a={};t.replace("#","").split("&").forEach(e=>{const t=e.split("=");a[t[0]]=t[[1]]}),a.staticView=e;const n=Object.keys(a).map(e=>"".concat(e,"=").concat(a[e])).join("&");return"".concat(window.location.origin,"/#").concat(n)}function Sa({open:e,handleClose:t}){const a=wa(),n=i.a.useState(""),o=Object(ua.a)(n,2),l=o[0],r=o[1];return i.a.createElement("div",{className:a.root},i.a.createElement(at.a,{open:e,onClose:()=>{t()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement(tt.a,{id:"alert-dialog-title"},"Share this display"),i.a.createElement(nt.a,null,i.a.createElement(ba.a,null,"To share the display in its current state, provide a descriptor for this state below and click the button to copy the link. The link can be shared with others and they will be brought to this state of the display in a read-only mode."),i.a.createElement(fa.a,{style:{marginBottom:15,marginTop:15},placeholder:"Enter description here",required:!0,fullWidth:!0,value:l,onChange:e=>{r(e.target.value)}}),i.a.createElement("div",{className:a.buttonContainer},i.a.createElement("div",{className:a.button},i.a.createElement(ot.a,{variant:"contained",color:"primary",size:"large",disabled:0===l.length,startIcon:i.a.createElement(ya.a,null),onClick:()=>{navigator.clipboard.writeText(xa(l))}},"Copy Link")),i.a.createElement("div",{className:a.link},xa(l)))),i.a.createElement(it.a,null,i.a.createElement(ot.a,{onClick:()=>{t()},color:"primary",autoFocus:!0},"Close"))))}class _a extends i.a.Component{constructor(e){super(e),this.handleShareDialogClose=()=>{this.setState({shareDialogOpen:!1})},this.handleShareDialogOpen=()=>{this.setState({shareDialogOpen:!0})},this.state={singleLoaded:""!==e.selectedDisplay.name,singleDisplay:e.displayList.isLoaded&&e.displayList.list.length<=1,shareDialogOpen:!1}}UNSAFE_componentWillReceiveProps(e){const t=this.state.singleLoaded,a=e.displayList.isLoaded&&e.displayList.list.length<=1;this.setState({singleDisplay:a}),!t&&a&&""!==e.selectedDisplay.name?this.setState({singleLoaded:!0}):!t&&a&&(e.selectDisplay(e.displayList.list[0].name,e.displayList.list[0].group,e.displayList.list[0].desc,e.cfg,e.appId,window.location.hash),this.setState({singleLoaded:!0}))}render(){const e=this.props,t=e.classes,a=e.styles,n=e.displayList,o=e.selectedDisplay,l=e.relatedDisplayGroups,r=e.displayGroups,s=e.doSetDialogOpen,c=e.dialogOpen,d=e.staticView,p=this.state,h=p.singleDisplay,m=p.shareDialogOpen;let g="",u="",b={visibility:"hidden"},f="",v="",y="";l&&Object.keys(l).length>0&&(y=i.a.createElement(Yt,{setDialogOpen:s}));const E=""!==o.name,w=Object.keys(r).length;return n.isLoaded&&!h&&(v=i.a.createElement(ea,{setDialogOpen:s})),E?(g=w>1?"".concat(o.group," /\n          ").concat(o.name):o.name.replace(/_/g," "),h||(b={color:"#aaa",fontSize:12}),u=o.desc,f=i.a.createElement(sa,null)):h?g="loading...":!c&&n.list.length>0&&(g=i.a.createElement("span",null,i.a.createElement("i",{className:"icon-arrow-left"}),"\xa0select a display to view...")),i.a.createElement("div",{className:t.headerContainer,style:a.headerContainer},v,y,i.a.createElement(pt,{singleDisplay:h,setDialogOpen:s}),i.a.createElement("i",{style:b,className:"fa fa-info-circle"}),i.a.createElement("div",{className:t.headerSubContainer,style:a.headerSubContainer},i.a.createElement("div",{className:t.nameDescContainer},i.a.createElement("div",{className:t.nameDescSubcontainer},i.a.createElement("div",{className:t.displayName,style:a.displayName},g,i.a.createElement("span",{style:{color:"red",paddingLeft:10}},d)),i.a.createElement("div",{className:t.displayDesc},u)),i.a.createElement("div",{className:t.headerShare,style:{display:""===d?"normal":"none"}},i.a.createElement(qe.a,{size:"small",onClick:this.handleShareDialogOpen},i.a.createElement(Je.a,null)))),i.a.createElement("div",{className:t.paginationContainer},f)),i.a.createElement(ga,{setDialogOpen:s,singleDisplay:h}),i.a.createElement(Sa,{open:m,handleClose:this.handleShareDialogClose}))}}const Oa={headerContainer:{position:"absolute",boxSizing:"border-box",top:0,left:0,height:lt.header.height,background:lt.header.background,color:lt.header.color,borderBottom:"1px solid ".concat(lt.header.borderColor),borderTop:"1px solid ".concat(lt.header.borderColor),borderLeft:"1px solid ".concat(lt.header.borderColor),margin:0,fontSize:lt.header.fontSize,fontWeight:300,zIndex:1010},headerSubContainer:{display:"flex",position:"absolute",top:0,height:lt.header.height},nameDescContainer:{display:"flex",flexDirection:"row",flex:"1 0",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},nameDescSubcontainer:{display:"flex",flexDirection:"column",height:lt.header.height},paginationContainer:{},displayName:{verticalAlign:"top",paddingLeft:15,fontSize:17,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},displayDesc:{verticalAlign:"top",fontWeight:300,paddingLeft:15,paddingRight:8,fontSize:10,fontStyle:"italic",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},headerShare:{paddingLeft:20,paddingTop:6}},Ca=Object(oe.a)(ve,Tt,le,jt,se,It,fe,we,e=>e.staticView,(e,t,a,n,i,o,l,r,s)=>({styles:{headerContainer:{width:t},headerSubContainer:{left:lt.header.height*((a.list.length<=1?0:1)+(""===i.name?0:1)+(0===Object.keys(o).length?0:1)),width:t-(lt.header.height*((a.list.length<=1?0:1)+(""===i.name?0:1)+(0===Object.keys(o).length?0:1))+lt.header.logoWidth+30)},displayName:{lineHeight:"".concat(""===i.desc?48:26,"px"),paddingTop:""===i.desc?0:5}},appId:e,cfg:l,displayList:a,displayGroups:n,selectedDisplay:i,relatedDisplayGroups:o,dialogOpen:r,staticView:s}));var ka=Object(r.b)(e=>Ca(e),e=>({selectDisplay:(t,a,n,i,o,l)=>{e(q(t,a,n)),e(ie(t,a,i,o,l))},doSetDialogOpen:t=>{e(W(t))}}))(Object(Ye.a)(Oa)(_a));a(208);const Ia={base:{position:"relative",width:lt.sideButtons.width,height:lt.sideButtons.width,lineHeight:"".concat(lt.sideButtons.width,"px"),textAlign:"center",verticalAlign:"middle",fontSize:lt.sideButtons.fontSize,color:lt.sideButtons.button.color,borderBottom:"1px solid ".concat(lt.sideButtons.button.borderColor),borderTop:"none",borderLeft:"none",borderRight:"none",userSelect:"none",background:lt.sideButtons.background,transition:"color 0.2s, background 0.2s","&:hover":{transition:"color 0.2s, background 0.2s",background:lt.sideButtons.button.hover.background,cursor:"pointer"}},active:{transition:"color 0.2s, background 0.2s",background:"white",color:lt.sideButtons.button.active.color,"&:hover":{transition:"color 0.2s, background 0.2s",background:lt.sideButtons.button.active.background}},icon:{lineHeight:"".concat(lt.sideButtons.fontSize,"px"),height:lt.sideButtons.fontSize,width:lt.sideButtons.width,position:"absolute",top:8,left:0},label:{fontSize:lt.sideButtons.labelFontSize,lineHeight:"".concat(lt.sideButtons.labelFontSize,"px"),width:lt.sideButtons.width,position:"absolute",bottom:4,left:0},bottom:{position:"absolute",bottom:0,left:0,borderTop:"1px solid",borderBottom:"0px"}};var Na=Object(Ye.a)(Ia)(({classes:e,isActive:t,icon:a,title:n,label:o,onClick:l})=>i.a.createElement("button",{className:Qt()({[e.base]:!0,[e.active]:t,[e.bottom]:"Configuration"===n}),type:"button",onClick:l},i.a.createElement("div",{className:e.icon},i.a.createElement("i",{className:a})),i.a.createElement("div",{className:e.label},o)));const Da=[{icon:"icon-th",label:"Grid",title:"Panel Grid Layout",key:"g"},{icon:"icon-list-ul",label:"Labels",title:"Show/Hide Labels",key:"l"},{icon:"icon-filter",label:"Filter",title:"Filter Panels",key:"f"},{icon:"icon-sort-amount-asc",label:"Sort",title:"Sort Panels",key:"s"},{icon:"icon-views",label:"Views",title:"Views",key:"v"}];class ja extends i.a.Component{constructor(e){super(e),this.handleKey=(e,t)=>{const a=this.props,n=a.dialogOpen,i=a.setActive,o=a.hasViews;if("v"!==t||o)if("INPUT"===e.target.nodeName||n)e.stopPropagation();else if("esc"===t||"enter"===t)i("");else{const e=[];for(let a=0;a<Da.length;a+=1)Da[a].key===t&&e.push(Da[a].title);e.length>0&&i(e[0])}},this.state={}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.active;t&&(Xe.a.bind(["g","l","f","s","c","v","enter"],this.handleKey),""!==a&&Xe.a.bindGlobal("esc",this.handleKey))}UNSAFE_componentWillReceiveProps(e){e.fullscreen?(Xe.a.bind(["g","l","f","s","c","v","enter"],this.handleKey),""!==e.active&&Xe.a.bindGlobal("esc",this.handleKey)):Xe.a.unbind(["g","l","f","s","c","v","esc","enter"])}componentWillUnmount(){this.props.fullscreen&&Xe.a.unbind(["g","l","f","s","c","v","esc","enter"])}render(){const e=this.props,t=e.classes,a=e.styles,n=e.active,o=e.hasViews,l=e.setActive;return i.a.createElement("div",{className:t.sideButtonsContainer,style:a.sideButtonsContainer},i.a.createElement("div",{className:t.spacer}),Da.map(e=>"Views"!==e.label||o?i.a.createElement(Na,{key:"sidebutton_".concat(e.title),isActive:e.title===n,icon:e.icon,title:e.title,label:e.label,onClick:()=>l(e.title)}):""))}}const Ta={sideButtonsContainer:{position:"absolute",left:0,top:0,paddingTop:lt.header.height,width:lt.sideButtons.width,background:lt.sideButtons.background,boxSizing:"border-box",zIndex:1e3},spacer:{transition:"height 0.2s",height:lt.sidebar.header.height,width:lt.sideButtons.width,background:lt.sideButtons.spacerBackground}},La=Object(oe.a)(Ft,Rt,we,Ee,re,(e,t,a,n,i)=>({styles:{sideButtonsContainer:{height:e+lt.header.height}},width:lt.sideButtons.width,active:t,dialogOpen:a,fullscreen:n,hasViews:i.info&&i.info.views&&i.info.views.length>0||!1}));var Ra=Object(r.b)(e=>La(e),e=>({setActive:t=>{e(F(t))}}))(Object(Ye.a)(Ta)(ja)),Aa=a(299),za=a(223),Pa=a(300);const Fa=Object(oe.a)(Ft,be,re,(e,t,a)=>({width:lt.sidebar.width,height:e-lt.sidebar.header.height,labels:t,cogInfo:a.info.cogInfo,curDisplayInfo:a}));var Wa=Object(r.b)(e=>Fa(e),e=>({handleChange:(t,a)=>{const n=a.indexOf(t);-1===n?a.push(t):a.splice(n,1),e(M(a))}}))(Object(Ye.a)({rowDesc:{color:"#888",fontStyle:"italic"},cogGroupHeader:{background:"#90CAF9",color:"white",fontWeight:400,fontSize:14,lineHeight:"29px"},cogGroupText:{paddingLeft:20}})(({classes:e,height:t,labels:a,cogInfo:n,curDisplayInfo:o,handleChange:l})=>{let r=i.a.createElement("div",null);const s=o.info.cogGroups;return Object.keys(n).length>0&&(r=i.a.createElement("div",{style:{height:t,overflowY:"auto",overflowX:"hidden"}},i.a.createElement(Aa.a,{style:{padding:0}},Object.keys(s).map(t=>{const o=s[t];return 0===o.length?null:i.a.createElement(i.a.Fragment,{key:t},!["condVar","common","panelKey"].includes(t)&&i.a.createElement(_t.a,{className:e.cogGroupHeader},i.a.createElement("span",{className:e.cogGroupText},"".concat(t," (").concat(o.length,")"))),s[t].sort().map(e=>i.a.createElement(za.a,{key:n[e].name,dense:!0,button:!0,onClick:()=>l(n[e].name,a)},i.a.createElement(Ot.a,{checked:-1!==a.indexOf(n[e].name),style:{width:20,height:20},tabIndex:-1,disableRipple:!0}),i.a.createElement(Pa.a,{primary:n[e].name,secondary:n[e].desc,style:{whiteSpace:"nowrap",textOverflow:"ellipsis"}}))))})))),r})),Ba=a(310),Ha=a(315),Va=a(302),Ma=a(301);class Ua extends i.a.Component{constructor(e){super(e),this.increment=()=>{const e=this.state,t=e.value,a=e.step,n=this.props,i=n.max,o=n.onChange,l=t+a;i&&l>i||(this.setState({value:l}),o&&o(l))},this.decrement=()=>{const e=this.state,t=e.value,a=e.step,n=this.props,i=n.min,o=n.onChange,l=t-a;i&&l<i||(this.setState({value:l}),o&&o(l))},this.handleChange=e=>{const t=this.props,a=t.min,n=t.max,i=t.onChange;this.setState({value:e.target.value});const o=parseFloat(e.target.value);if(!Number.isNaN(o)&&i){let e=!0;a&&o<a&&(e=!1),n&&o>n&&(e=!1),e&&i(o)}};let t=1;e.step&&(t=e.step),this.state={value:e.value,step:t},this.mousetrap=null}componentDidMount(){this.mousetrap=new Xe.a(this._NumericInput),this.mousetrap.bind("up",()=>this.increment()),this.mousetrap.bind("down",()=>this.decrement()),this.mousetrap.bind("esc",()=>(this._NumericInput.blur(),!1)),this.mousetrap.bind(["left","right","g","l","s","f","c","a","i","o","r"],e=>e.stopPropagation())}UNSAFE_componentWillReceiveProps(e){this.setState({value:e.value})}componentWillUnmount(){this.mousetrap.unbind("up"),this.mousetrap.unbind("down"),this.mousetrap.unbind("esc"),this.mousetrap.unbind(["left","right","g","l","s","f","c","a","i","o","r"])}render(){const e=this.props,t=e.classes,a=e.arrows,n=e.size,o=this.state.value;let l="";return a&&(l=i.a.createElement("span",null,i.a.createElement("button",{type:"button",key:"up-button",className:"".concat(t.b," ").concat(t.b1),onClick:this.increment,tabIndex:"-1"},i.a.createElement("i",{className:"".concat(t.i," ").concat(t.i1)})),i.a.createElement("button",{type:"button",key:"down-button",className:"".concat(t.b," ").concat(t.b2),onClick:this.decrement,tabIndex:"-1"},i.a.createElement("i",{className:"".concat(t.i," ").concat(t.i2)})))),i.a.createElement("span",{className:t.span},i.a.createElement("input",{ref:e=>{this._NumericInput=e},type:"text",size:n||4,className:"mousetrap ".concat(t.input),value:o,onChange:this.handleChange}),l)}}const Ga={span:{position:"relative",display:"inline-block",borderRadius:0,fontSize:13},input:{padding:"3px 10px 3px 6px",boxSizing:"border-box",height:28,width:"auto",fontSize:15,borderRadius:2,fontFamily:lt.fontFamily,border:"1px solid rgb(204, 204, 204)",display:"block",lineHeight:"normal"},b:{position:"absolute",right:2,width:15,borderColor:"rgba(0, 0, 0, 0.0980392)",borderStyle:"solid",textAlign:"center",cursor:"pointer",transition:"all 0.1s",boxShadow:"none","&:hover":{background:"rgba(0, 0, 0, 0.2)",boxShadow:"0 0 0 0.5px rgba(0, 0, 0, 0.3)"}},b1:{top:2,bottom:"50%",borderRadius:"2px 2px 0px 0px",borderWidth:"1px 1px 0px",background:"rgba(0, 0, 0, 0.0980392)",height:12},b2:{top:"50%",bottom:2,borderRadius:"0px 0px 2px 2px",borderWidth:"0px 1px 1px",background:"rgba(0, 0, 0, 0.0980392)",height:12},i:{position:"absolute",top:"50%",left:"50%",width:0,height:0},i1:{borderWidth:"0px 0.6ex 0.6ex",borderColor:"transparent transparent rgba(0, 0, 0, 0.701961)",borderStyle:"solid",margin:"-0.3ex 0px 0px -0.56ex"},i2:{borderWidth:"0.6ex 0.6ex 0px",borderColor:"rgba(0, 0, 0, 0.701961) transparent transparent",borderStyle:"solid",margin:"-0.3ex 0px 0px -0.56ex"}};var Ka=Object(Ye.a)(Ga)(Ua);const Ya={row:{paddingLeft:15,paddingRight:15,paddingTop:8,paddingBottom:6,height:42,boxSizing:"border-box",fontSize:16,width:lt.sidebar.width,display:"inline-block"},label:{lineHeight:"28px",float:"left"},nInput:{float:"right"},inputRadio:{marginBottom:5,marginTop:0},inputLabelSpan:{lineHeight:"40px",verticalAlign:"middle",fontSize:16},inputIcon:{fontSize:23,paddingLeft:6,verticalAlign:"text-bottom"},relDisp:{fontSize:14,padding:15},relDispText:{paddingBottom:10},relDispButton:{textAlign:"center"}},qa=Object(oe.a)(ue,e=>e.selectedRelDisps,(e,t)=>({layout:e,hasRelDisps:t.length>0}));var Qa=Object(r.b)(e=>qa(e),e=>({handleChange:t=>{e(V(t))},resetRelDisps:()=>{e(Q([])),e(J([]))}}))(Object(Ye.a)(Ya)(({classes:e,layout:t,hasRelDisps:a,handleChange:n,resetRelDisps:o})=>{let l=i.a.createElement("div",null);return a?l=i.a.createElement("div",{className:e.relDisp},i.a.createElement("div",{className:e.relDispText},"Grid layout cannot be changed when viewing related displays."),i.a.createElement("div",{className:e.relDispButton},i.a.createElement(ot.a,{variant:"outlined",color:"primary",onClick:o,size:"small"},"Remove Related Displays"))):t.nrow&&(l=i.a.createElement("div",null,i.a.createElement("div",{className:e.row},i.a.createElement("div",{className:e.label},"Rows:"),i.a.createElement("div",{className:e.nInput},i.a.createElement(Ka,{arrows:!0,value:t.nrow,size:3,min:1,max:15,step:1,onChange:e=>n({nrow:e,ncol:t.ncol,arrange:t.arrange})}))),i.a.createElement(Ma.a,null),i.a.createElement("div",{className:e.row},i.a.createElement("div",{className:e.label},"Columns:"),i.a.createElement("div",{className:e.nInput},i.a.createElement(Ka,{arrows:!0,value:t.ncol,size:3,min:1,max:15,step:1,onChange:e=>n({nrow:t.nrow,ncol:e,arrange:t.arrange})}))),i.a.createElement(Ma.a,null),i.a.createElement("div",{className:e.row},"Arrangement:"),i.a.createElement("div",{className:e.row},i.a.createElement(Ha.a,{name:"arrangement",value:t.arrange,onChange:(e,a)=>n({nrow:t.nrow,ncol:t.ncol,arrange:a})},i.a.createElement(Va.a,{value:"row",control:i.a.createElement(Ba.a,null),label:i.a.createElement("span",{className:e.inputLabelSpan},"By row",i.a.createElement("i",{className:"icon-byrow ".concat(e.inputIcon)})),className:e.inputRadio}),i.a.createElement(Va.a,{value:"column",control:i.a.createElement(Ba.a,null),label:i.a.createElement("span",{className:e.inputLabelSpan},"By column",i.a.createElement("i",{className:"icon-bycol ".concat(e.inputIcon)})),className:e.inputRadio}))))),l})),Ja=a(61),$a=a(79),Xa=a.n($a),Za=a(303);const en={tableWrap:{overflowY:"auto",overflowX:"hidden"},table:{width:lt.sidebar.width-5,borderCollapse:"collapse",borderSpacing:0,tableLayout:"fixed"},tr:{width:lt.sidebar.width-5,height:48,borderBottom:"1px solid rgb(224, 224, 224)"},sortButton:{verticalAlign:"middle",width:45,textAlign:"center"},labels:{fontSize:13,height:48,width:lt.sidebar.width-45-45-5,verticalAlign:"middle",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},closeButton:{height:48,width:45,textAlign:"center",verticalAlign:"middle"},notUsedHeader:{height:30,lineHeight:"30px",paddingLeft:10,boxSizing:"border-box",width:lt.sidebar.width,fontSize:14},notUsed:{width:lt.sidebar.width,overflowY:"auto",boxSizing:"border-box",paddingLeft:10,paddingRight:10,paddingBottom:10},variable:{display:"inline-block",boxShadow:"rgba(0, 0, 0, 0.117647) 0px 1px 6px, rgba(0, 0, 0, 0.117647) 0px 1px 4px",borderRadius:10,border:0,background:"none",paddingTop:"2px !important",paddingBottom:"3px !important",paddingLeft:"7px !important",paddingRight:"7px !important",margin:"3px !important",fontSize:12,color:"black",cursor:"pointer",transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms","&:hover":{transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",background:"#ebebeb"}},cogGroupHeader:{background:"#90CAF9",marginLeft:-10,marginRight:-10,marginTop:10,marginBottom:10,paddingTop:5,paddingBottom:5,color:"white",fontWeight:400,fontSize:14},cogGroupText:{paddingLeft:20}},tn=Object(oe.a)(re,e=>{const t={},a=Object.keys(e.info.cogInfo);for(let n=0;n<a.length;n+=1)t[a[n]]=e.info.cogInfo[a[n]].desc;return t}),an=Object(oe.a)(ge,tn,At,be,re,(e,t,a,n,i)=>{const o=51*e.length>a-102;let l=51*e.length;if(o){l=51*Math.ceil(.6*a/51)-25}return{styles:{tableWrap:{maxHeight:l},notUsed:{height:a-l-30}},sort:e,cogDesc:t,labels:n,curDisplayInfo:i}});var nn=Object(r.b)(e=>an(e),e=>({handleChange:t=>{e(U(t)),e(V({pageNum:1}))},addLabel:(t,a)=>{if(a.indexOf(t)<0){const n=Object.assign([],a);n.push(t),e(M(n))}}}))(Object(Ye.a)(en)(({classes:e,styles:t,sort:a,cogDesc:n,labels:o,handleChange:l,addLabel:r,curDisplayInfo:s})=>{let c=i.a.createElement("div",null);const d=s.info.cogGroups;if(n){const s=Object.keys(n);for(let e=0;e<a.length;e+=1){const t=s.indexOf(a[e].name);t>-1&&s.splice(t,1)}c=i.a.createElement("div",null,i.a.createElement("div",{className:e.tableWrap,style:t.tableWrap},i.a.createElement("table",{className:e.table},i.a.createElement("tbody",null,a.map((t,o)=>{const r="asc"===t.dir?"up":"down";return i.a.createElement("tr",{className:e.tr,key:"".concat(t.name,"_tr")},i.a.createElement("td",{className:e.sortButton},i.a.createElement(qe.a,{color:"primary",key:"".concat(t.name,"_button"),onClick:()=>{const e=Object.assign([],a);e[o].dir="asc"===e[o].dir?"desc":"asc",l(e)}},i.a.createElement("i",{className:"icon-chevron-".concat(r),style:{fontSize:16}}))),i.a.createElement("td",{className:e.labels},t.name,i.a.createElement("br",null),i.a.createElement("span",{style:{color:"#888",fontStyle:"italic"}},n[t.name])),i.a.createElement("td",{className:e.closeButton},i.a.createElement(qe.a,{onClick:()=>l(o)},i.a.createElement(Za.a,{className:"icon-times",style:{fontSize:16,color:"#aaa"}}))))})))),i.a.createElement("div",{className:e.notUsedHeader},0===a.length?"Select a variable to sort on:":0===s.length?"":"More variables:"),i.a.createElement("div",{className:e.notUsed,style:t.notUsed},Object.keys(d).map(t=>{const c=Xa()(s,d[t]);return 0===c.length?null:i.a.createElement(i.a.Fragment,{key:t},!["condVar","common","panelKey"].includes(t)&&i.a.createElement("div",{className:e.cogGroupHeader},i.a.createElement("span",{className:e.cogGroupText},"".concat(t," (").concat(c.length,")"))),c.sort().map(t=>i.a.createElement("span",{key:"".concat(t,"_notused")},i.a.createElement("span",{"data-tip":!0,"data-for":"tooltip_".concat(t)},i.a.createElement("button",{type:"button",className:e.variable,key:"".concat(t,"_button"),onClick:()=>{const e=Object.assign([],a);e.push({name:t,dir:"asc"}),r(t,o),l(e)}},t)),i.a.createElement(Ja.a,{place:"right",id:"tooltip_".concat(t)},i.a.createElement("span",null,n[t])))))})))}return c})),on=a(161),ln=a(304),rn=a(145),sn=a.n(rn),cn=a(155);class dn extends i.a.Component{constructor(e){super(e),this.mouseOver=()=>{this.setState({hover:!0})},this.mouseOut=()=>{this.setState({hover:!1})},this.state={hover:!1}}render(){const e=this.props,t=e.classes,a=e.width,n=e.height,o=e.d,l=e.divStyle,r=e.handleClick,s=e.active,c=e.allActive,d=this.state.hover,p=Math.min(10,n-6),h=Math.min(9,n-7),m=o.ct===o.mct?o.mct:"".concat(o.ct," / ").concat(o.mct);return i.a.createElement("div",{className:Qt()({[t.wrapper]:!0,[t.wrapperHover]:d}),style:l,onMouseOver:this.mouseOver,onFocus:this.mouseOver,onMouseOut:this.mouseOut,onBlur:this.mouseOut,onClick:r},i.a.createElement("div",{className:Qt()({[t.bar]:!0,[t.barHover]:d,[t.barActive]:s&&!d,[t.barAllActive]:c&&!d}),style:{width:a,height:n-1}},i.a.createElement("div",{className:t.barText,style:{fontSize:p,lineHeight:"".concat(n-1,"px"),width:a}},i.a.createElement("div",{className:t.barTextInner},o.id))),i.a.createElement("div",{className:Qt()({[t.barLabel]:!0,[t.hidden]:!d}),style:{labelFontSize:h,lineHeight:"".concat(n-1,"px")}},m))}}const pn={wrapper:{background:"white"},wrapperHover:{background:"#f6f6f6"},bar:{background:lt.sidebar.filter.cat.bar.color.default,color:lt.sidebar.filter.cat.text.color.default,position:"absolute",left:0},barHover:{background:lt.sidebar.filter.cat.bar.color.hover,color:lt.sidebar.filter.cat.text.color.hover},barActive:{background:lt.sidebar.filter.cat.bar.color.select,color:lt.sidebar.filter.cat.text.color.select},barAllActive:{background:lt.sidebar.filter.cat.bar.color.noneSelect,color:lt.sidebar.filter.cat.text.color.select},barLabel:{fontSize:10,color:"#444",textAlign:"center",cursor:"default",position:"absolute",lineHeight:"19px",right:4},hidden:{visibility:"hidden"},barText:{display:"inline-block",overflow:"hidden",cursor:"default"},barTextInner:{display:"inline-block",whiteSpace:"nowrap",position:"absolute",left:5,bottom:0}};var hn=Object(Ye.a)(pn)(dn);class mn extends i.a.Component{constructor(...e){super(...e),this.barCellRenderer=e=>{const t=this.props,a=t.condDist,n=t.sortOrder,o=t.filterState,l=t.cellHeight,r=t.width,s=t.dist;let c=0,d=0,p="",h=0,m=!0;const g=a.totSelected;let u;return u=e.rowIndex<g?a.reverseRows?e.rowIndex:g-(e.rowIndex+1):a.reverseRows?e.rowIndex:a.dist.length-(e.rowIndex-g+1),u=a.idx[u],m=e.rowIndex<g,c=a.dist[u].value,d=c,p=a.dist[u].key,h=a.max,i.a.createElement(hn,{key:"".concat(e.rowIndex,"_").concat(d,"_").concat(n),style:null,divStyle:e.style,active:m,allActive:void 0===o.value,height:l,width:c/h*(r-1)+1,handleClick:()=>this.handleSelect(p,m),d:{ct:d,mct:s.dist[p],id:p}})}}handleSelect(e,t){const a=this.props,n=a.filterState,i=a.sortOrder,o=a.handleChange,l=Object.assign([],n.value);if(t){const t=l.indexOf(e);t>-1&&l.splice(t,1)}else l.push(e);let r={};r=0===l.length?{name:n.name,varType:n.varType,orderValue:i}:{name:n.name,type:"select",varType:n.varType,value:l,orderValue:i},o(r)}render(){const e=this.props,t=e.condDist,a=e.filterCardinality,n=e.width,o=e.height,l=e.cellHeight,r=t.orderValue,s=t.totSelected,c=t.sumSelected,d=a;return i.a.createElement(cn.a,{key:"".concat(r,"_").concat(s,"_").concat(c,"_").concat(d),width:n,height:o,columnWidth:n,rowHeight:l,columnCount:1,rowCount:t.dist.length,cellRenderer:this.barCellRenderer})}}const gn=Object(oe.a)(Oe,e=>({filterCardinality:e}));var un=Object(r.b)(e=>gn(e))(mn);const bn=[{payload:"ct,asc",text:"Order: count ascending"},{payload:"ct,desc",text:"Order: count descending"},{payload:"id,asc",text:"Order: label ascending"},{payload:"id,desc",text:"Order: label descending"}];class fn extends i.a.Component{constructor(e){super(e),this.handleMenuClose=()=>{this.setState({menuOpen:!1})},this.handleMenuIconClick=e=>{const t=this.state.menuOpen;this.setState({menuOpen:!t}),this.setState({anchorEl:t?null:e.currentTarget})};const t=this.props.filterState;this.sortOrder=t.orderValue?t.orderValue:"ct,desc",this.state={menuOpen:!1,anchorEl:null}}UNSAFE_componentWillUpdate(){const e=this.props.filterState;this.sortOrder=e.orderValue?e.orderValue:"ct,desc"}handleRegex(e){const t=this.props,a=t.filterState,n=t.levels,i=t.handleChange;let o={};if(""===e)o={name:a.name,varType:a.varType,orderValue:this.sortOrder};else{const t=[],i=new RegExp(e,"i");n.forEach(e=>{null!==e.match(i)&&t.push(e)}),o={name:a.name,type:"regex",varType:a.varType,regex:e,value:t,orderValue:this.sortOrder}}i(o)}render(){const e=this.props,t=e.classes,a=e.handleSortChange,n=e.filterState,o=e.height,l=e.dist,r=e.condDist,s=e.handleChange,c={width:lt.sidebar.width-40,marginTop:-8,fontSize:16,transform:"scale(0.85)",transformOrigin:"0 0"},d=this.state,p=d.menuOpen,h=d.anchorEl,m=i.a.createElement("div",{className:t.extraOptionsInput},i.a.createElement(qe.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:this.handleMenuIconClick},i.a.createElement(sn.a,null)),i.a.createElement(on.a,{id:"long-menu",open:p,anchorEl:h,onClose:this.handleMenuClose},bn.map(e=>i.a.createElement(ln.a,{key:e.payload,selected:e.payload===n.orderValue,onClick:()=>{a(Object.assign(n,{orderValue:e.payload})),this.handleMenuClose()}},e.text))));return i.a.createElement("div",{className:t.container},i.a.createElement("div",{className:t.plotContainer},i.a.createElement(un,{className:t.plotContainer,height:o,width:lt.sidebar.width-2*lt.sidebar.filter.margin,cellHeight:15,dist:l,condDist:r,filterState:n,handleChange:s,sortOrder:this.sortOrder})),i.a.createElement("div",{className:t.inputContainer},i.a.createElement(fa.a,{placeholder:"regex",style:c,value:"regex"===n.type?n.regex:"",onChange:e=>this.handleRegex(e.target.value)}),m))}}const vn={container:{width:lt.sidebar.width-2*lt.sidebar.filter.margin,boxSizing:"border-box",paddingLeft:lt.sidebar.filter.margin,paddingRight:lt.sidebar.filter.margin,paddingTop:lt.sidebar.filter.margin},plotContainer:{width:lt.sidebar.width-2*lt.sidebar.filter.margin,boxSizing:"border-box",position:"relative",overflow:"hidden",cursor:"default",userSelect:"none",zIndex:1e3},inputContainer:{height:39,width:lt.sidebar.width-2*lt.sidebar.filter.margin,marginBottom:-21,paddingTop:7,zIndex:100,position:"relative"},extraOptionsInput:{float:"right",marginTop:-6,width:28,transform:"scale(0.6)",transformOrigin:"0 0"}};var yn=Object(Ye.a)(vn)(fn),En=a(307),wn=a(159),xn=a(305),Sn=a(102),_n=a(105);const On={};class Cn extends i.a.Component{componentDidMount(){const e=this.props,t=e.condDist,a=e.width,n=e.height,i=t.delta,o=[t.breaks[0],t.breaks[t.breaks.length-1]+i],l=Object(En.a)().domain(o).range([5,a-5]),r=Object(En.a)().domain([0,t.max]).range([n-16,0]),s=Object(wn.a)(r).scale(l).ticks(5).tickSize(4),c=n-16,d=l(i)-l(0);this.d3pars={axisPad:16,sidePad:5,delta:i,xrange:o,xs:l,ys:r,axis:s,height:c,barWidth:d,barPath:(e,t)=>{const a=[];let n=0;const i=e.length;let o,l;for(;n<i;)o=e[n],l=0===o.value?t.ys(o.value):t.ys(o.value)-1,a.push("M",t.xs(o.key)+1,",",t.height,"V",l,"h",t.barWidth-1,"V",t.height),n+=1;return a.join("")}},this._d3node.call(On.enter.bind(this,this.props,this.d3pars))}componentDidUpdate(){const e=this.props.condDist;this.d3pars.ys.domain([0,e.max]),this._d3node.call(On.update.bind(this,this.props,this.d3pars))}render(){const e=this.props,t=e.width,a=e.height;return i.a.createElement("svg",{ref:e=>{this._d3node=Object(xn.a)(e)},width:t,height:a})}}var kn=Cn;On.enter=(e,t,a)=>{const n=Object(_n.a)().extent([[t.sidePad,1],[e.width-t.sidePad,t.height+1]]).handleSize(10);n.on("brush",()=>{const e=Sn.c.selection;a.select("#cliprect").attr("x",e[0]).attr("width",e[1]-e[0])}).on("end",()=>{if(Sn.c.sourceEvent)if(Sn.c.selection){const a=Sn.c.selection.map(e=>(e=>{const t=Math.max(Math.floor(Math.log10(Math.abs(e))),5);return parseFloat(e.toPrecision(t))})(t.xs.invert(e)));e.handleChange(a)}else a.select("#cliprect").attr("x",t.xs(t.xrange[0])).attr("width",t.xs(t.xrange[1])-t.xs(t.xrange[0])),e.handleChange(void 0)});const i=a.append("g"),o=Object.assign([],t.xrange);e.filterState.value&&(e.filterState.value.from&&(o[0]=e.filterState.value.from),e.filterState.value.to&&(o[1]=e.filterState.value.to)),i.append("clipPath").attr("id","clip-".concat(e.name)).append("rect").attr("id","cliprect").attr("x",t.xs(o[0])).attr("width",t.xs(o[1])-t.xs(o[0])).attr("height",e.height-t.axisPad),i.append("path").attr("class","bar background").datum(e.condDist.dist).attr("fill","#ddd"),i.append("path").attr("class","bar foreground").datum(e.condDist.dist).attr("clip-path","url(#clip-".concat(e.name,")")),e.filterState.value?i.selectAll(".foreground").attr("fill","rgb(255, 170, 10)"):i.selectAll(".foreground").attr("fill","rgb(255, 210, 127)");const l=a.append("g").attr("class","axis").attr("transform","translate(0,".concat(e.height-t.axisPad+1,")")).call(t.axis);l.select("path").attr("fill","none").attr("stroke","#000").attr("stroke-opacity",.4).attr("shape-rendering","crispEdges"),l.selectAll(".tick").attr("opacity",.4);const r=i.append("g").attr("class","brush").call(n);e.filterState.value&&r.call(n.move,[t.xs(o[0]),t.xs(o[1])]),r.select("rect.selection").attr("fill","rgb(255, 210, 127)").attr("fill-opacity","0.125").attr("stroke","rgb(255, 170, 10)").attr("stroke-opacity","0.2"),r.selectAll("rect").attr("height",t.height),a.selectAll(".bar").attr("d",e=>t.barPath(e,t))},On.update=(e,t,a)=>{if(a.selectAll(".bar").attr("d",null).datum(e.condDist.dist).attr("d",e=>t.barPath(e,t)),void 0!==e.filterState.value){let n=e.filterState.value.from,i=e.filterState.value.to;void 0===n&&(n=t.xrange[0]),void 0===i&&(i=t.xrange[1]),i>n&&(a.select(".brush").call(Object(_n.a)().move,[t.xs(n),t.xs(i)]),a.select("#cliprect").attr("x",t.xs(n)).attr("width",t.xs(i)-t.xs(n)),a.selectAll("path.foreground").attr("fill","rgb(255, 170, 10)"))}else a.select(".brush").call(Object(_n.a)().move,null),a.selectAll("path.foreground").attr("fill","rgb(255, 210, 127)"),a.select("#cliprect").attr("x",t.xs(t.xrange[0])).attr("width",t.xs(t.xrange[1])-t.xs(t.xrange[0]))};class In extends i.a.Component{constructor(e){super(e),this.stateValue={},this.handleBrushInput=this.handleBrushInput.bind(this)}componentDidUpdate(){void 0===this.props.filterState.value&&this._fromInput&&this._toInput&&(this._fromInput.input.value=null,this._toInput.input.value=null)}setValidState(e,t,a){const n=this.props,i=n.filterState,o=n.handleChange,l=this.checkValidNumber(e,t,a);void 0!==i.valid&&i.valid===l||o(Object.assign(i,{valid:l}))}handleInput(e,t){const a=this.props,n=a.filterState,i=a.handleChange;let o={};const l=""===e?void 0:parseFloat(e),r="from"===t?l:this.stateValue.from,s="to"===t?l:this.stateValue.to;o=void 0===r&&void 0===s?{name:n.name,type:"range",varType:n.varType,valid:!0}:{name:n.name,type:"range",varType:n.varType,value:{from:r,to:s},valid:this.checkValidNumber(r,s,t)},i(o)}handleBrushInput(e){const t=this.props,a=t.filterState,n=t.handleChange;if(void 0===e){n({name:a.name,type:"range",varType:a.varType,valid:!0}),this._fromInput&&this._toInput&&(this._fromInput.input.value=null,this._toInput.input.value=null)}else{if(n({name:a.name,type:"range",varType:a.varType,value:{from:e[0],to:e[1]},valid:!0}),this._fromInput&&this._toInput){var i=Object(ua.a)(e,2);this._fromInput.input.value=i[0],this._toInput.input.value=i[1]}}}checkValidNumber(e,t,a){if("to"===a){if(e&&parseFloat(e)>parseFloat(t))return!1}else if(t&&parseFloat(t)<parseFloat(e))return!1;return!0}render(){const e=this.props,t=e.classes,a=e.filterState,n=e.dist,o=e.condDist,l=e.name,r={textAlign:"center"};void 0===a.valid||a.valid||(r.color="red");const s={width:75,marginTop:-5,fontSize:16,transform:"scale(0.85)",transformOrigin:"0 0"},c={textAlign:"center",paddingBottom:2};this.stateValue=a.value,void 0===this.stateValue&&(this.stateValue={});const d=this.stateValue,p=d.to,h=d.from;p&&h&&p<h&&(c.color="red");const m=n.dist.raw.breaks,g=(m[1]-m[0])*m.length,u=Math.pow(10,Math.round(Math.log10(g/100)-.4));return i.a.createElement("div",{className:t.container},i.a.createElement("div",{className:t.plotContainer},i.a.createElement(kn,{name:l,className:t.plotContainer,width:lt.sidebar.width-2*lt.sidebar.filter.margin,height:lt.sidebar.filter.num.height,dist:n,condDist:o,filterState:a,handleChange:this.handleBrushInput})),i.a.createElement("div",{className:t.inputContainer},i.a.createElement("div",{className:t.rangeInputText},"Range:"),i.a.createElement(fa.a,{name:"fromText",style:s,inputProps:{style:c},type:"number",step:u,value:this.stateValue.from?this.stateValue.from:"",onChange:e=>this.handleInput(e.target.value,"from")}),i.a.createElement("div",{className:"".concat(t.rangeInputText," ").concat(t.rangeInputTextDash)},"-"),i.a.createElement(fa.a,{name:"toText",style:s,inputProps:{style:c},type:"number",step:u,value:this.stateValue.to?this.stateValue.to:"",onChange:e=>this.handleInput(e.target.value,"to")})))}}const Nn={container:{marginLeft:5,marginRight:5,marginTop:5},plotContainer:{width:lt.sidebar.width-2*lt.sidebar.filter.margin,height:lt.sidebar.filter.num.height,position:"relative",overflow:"hidden",cursor:"default",userSelect:"none",zIndex:1e3},inputContainer:{width:lt.sidebar.width-2*lt.sidebar.filter.margin,marginBottom:-12,paddingBottom:8,paddingTop:4,zIndex:100,position:"relative",verticalAlign:"center"},rangeInputText:{fontSize:13,paddingRight:10,display:"inline-block"},rangeInputTextDash:{paddingLeft:4,transform:"scale(2,1)"}};var Dn=Object(Ye.a)(Nn)(In);const jn={col1:{position:"absolute",top:lt.sidebar.header.height,left:0},col2:{position:"absolute",top:lt.sidebar.header.height,left:lt.sidebar.width,borderLeft:"1px solid ".concat(lt.sidebar.borderColor)},notUsedHeader:{height:30,lineHeight:"30px",paddingLeft:10,boxSizing:"border-box",width:lt.sidebar.width,fontSize:14},notUsedContainer:{width:lt.sidebar.width,overflowY:"auto",boxSizing:"border-box",paddingLeft:10,paddingRight:10,paddingBottom:10},variable:{display:"inline-block",boxShadow:"rgba(0, 0, 0, 0.117647) 0px 1px 6px, rgba(0, 0, 0, 0.117647) 0px 1px 4px",borderRadius:10,paddingTop:"2px !important",paddingBottom:"3px !important",paddingLeft:"7px !important",paddingRight:"7px !important",border:0,background:"white",margin:"3px !important",fontSize:12,cursor:"pointer",color:"black",transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms","&:hover":{transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",background:"#ebebeb"}},variableActive:{background:"#81C784",color:"white","&:hover":{background:Object(Jt.emphasize)("#81C784",.2)}},allContainer:{width:lt.sidebar.width,boxSizing:"border-box"},container:{width:lt.sidebar.width,boxSizing:"border-box",zIndex:100,position:"relative",paddingBottom:6,borderBottom:"1px solid ".concat(lt.sidebar.borderColor)},header:{height:16,lineHeight:"15px",width:lt.sidebar.width,marginTop:1,fontSize:12,position:"relative"},headerExtra:{position:"absolute",right:38,height:16,lineHeight:"15px",fontSize:11,color:"#777"},headerName:{height:16,paddingLeft:5,paddingRight:5,position:"absolute",left:1,userSelect:"none",cursor:"default",background:"#999"},headerNameActive:{background:"#81C784"},headerNameText:{color:"white"},headerIcon:{height:16,color:"#666",cursor:"pointer",position:"absolute",border:"none",background:"none",marginTop:-1,padding:0,zIndex:1e3,"&:hover":{transition:"all 150ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",color:"#aaa"}},headerIconHide:{visibility:"hidden"},headerClose:{right:5},headerReset:{right:18},cogGroupHeader:{background:"#90CAF9",marginLeft:-10,marginRight:-10,marginTop:10,marginBottom:10,paddingTop:5,paddingBottom:5,color:"white",fontWeight:400,fontSize:14},cogGroupText:{paddingLeft:20}},Tn=Object(oe.a)(he,me,Dt,At,re,Se,zt,be,(e,t,a,n,i,o,l,r)=>({styles:{col1:{height:n},col2:{height:n,display:null===l.cutoff?"none":"inline"},notUsedContainer:{height:n-35-l.heights[null===l.cutoff?0:1]},allContainer:{height:n}},catHeight:lt.sidebar.filter.cat.height,filter:e,filterView:t,cogInfo:a,curDisplayInfo:i,filtDist:o,colSplit:l,labels:r}));var Ln=Object(r.b)(e=>Tn(e),e=>({handleViewChange:(t,a,n)=>{if("add"===a&&n.indexOf(t)<0){const a=Object.assign([],n);a.push(t),e(M(a))}e(K(t,a))},handleFilterChange:t=>{let a;"string"===typeof t||t instanceof String?a=t:(a={},a[t.name]=Object(Te.a)({},t)),e(G(a)),e(V({pageNum:1}))},handleFilterSortChange:t=>{const a={};a[t.name]=t,e(G(a))}}))(Object(Ye.a)(jn)(({classes:e,styles:t,catHeight:a,filter:n,filterView:o,cogInfo:l,curDisplayInfo:r,filtDist:s,colSplit:c,handleViewChange:d,handleFilterChange:p,handleFilterSortChange:h,labels:m})=>{let g=i.a.createElement("div",null);const u=r.info.name,b=r.info.cogGroups;if(n&&o.active&&c){let f=[],v=[];null===c.cutoff?f=o.active:(f=o.active.slice(0,c.cutoff),v=o.active.slice(c.cutoff,o.active.length));const y=[f,v].map(t=>t.map((t,o)=>{if(s[t]){let o=n[t],c="";const m=o&&void 0!==o.value;let g=i.a.createElement("div",{key:"".concat(t,"_").concat(u)},t);if("factor"===l[t].type||"time"===l[t].type||"date"===l[t].type){o||(o={name:t,orderValue:"ct,desc",type:"select",varType:"factor"});const e=l[t].levels?l[t].levels.length:1e3;g=i.a.createElement(yn,{filterState:o,height:Math.min(a,15*e),dist:r.info.cogDistns[t],condDist:s[t],levels:r.info.cogInfo[t].levels,handleChange:p,handleSortChange:h}),c="".concat(s[t].totSelected," of ").concat(s[t].dist.length)}else"numeric"===l[t].type&&(o||(o={name:t,orderValue:"ct,desc",type:"range",varType:"numeric"}),g=i.a.createElement(Dn,{name:t,filterState:o,dist:r.info.cogDistns[t],condDist:s[t],handleChange:p}));return i.a.createElement("div",{key:"".concat(t,"_").concat(u),className:e.container},i.a.createElement("div",{className:e.header},i.a.createElement("div",{className:Qt()({[e.headerName]:!0,[e.headerNameActive]:m})},i.a.createElement("span",{"data-tip":!0,"data-for":"hdtooltip_".concat(t)},i.a.createElement("span",{className:e.headerNameText},t))),i.a.createElement(Ja.a,{place:"right",id:"hdtooltip_".concat(t)},i.a.createElement("span",null,l[t].desc)),i.a.createElement("div",{className:e.headerExtra},c),i.a.createElement("button",{type:"button",key:"".concat(t,"_").concat(u,"-close-icon"),className:"".concat(e.headerIcon," ").concat(e.headerClose),onMouseDown:()=>d(t,"remove")},i.a.createElement("i",{className:"icon-times-circle"})),i.a.createElement("button",{type:"button",key:"".concat(t,"_").concat(u,"-reset-icon"),className:Qt()({[e.headerIcon]:!0,[e.headerReset]:!0,[e.headerIconHide]:!m}),onMouseDown:()=>p(o.name)},i.a.createElement("i",{className:"icon-undo"}))),g)}return""})),E=null===c.cutoff?0:1,w=Object.keys(l),x=Xa()(w,o.inactive);t.notUsedContainer.height<170&&1===E?y[E].push(i.a.createElement("div",{key:"notUsedHeader",className:e.notUsedHeader},"Remove filters to select more.")):(y[E].push(i.a.createElement("div",{key:"notUsedHeader",className:e.notUsedHeader},0===o.active.length?"Select a variable to filter on:":0===o.inactive.length?"":"More variables:")),y[E].push(i.a.createElement("div",{key:"notUsed",className:e.notUsedContainer,style:t.notUsedContainer},Object.keys(b).map(t=>{const a=Xa()(x,b[t]);return 0===a.length?null:i.a.createElement(i.a.Fragment,{key:t},!["condVar","common","panelKey"].includes(t)&&i.a.createElement("div",{className:e.cogGroupHeader},i.a.createElement("span",{className:e.cogGroupText},"".concat(t," (").concat(a.length,")"))),b[t].sort().map(t=>i.a.createElement(i.a.Fragment,{key:"".concat(t,"_").concat(u)},x.includes(t)&&i.a.createElement("span",null,i.a.createElement("span",{"data-tip":!0,"data-for":"tooltip_".concat(t)},i.a.createElement("button",{type:"button",className:Qt()({[e.variable]:!0,[e.variableActive]:n[t]&&void 0!==n[t].value}),key:"".concat(t,"_").concat(u,"_button_").concat(x.length),onClick:()=>d(t,"add",m)},t)),i.a.createElement(Ja.a,{place:"right",id:"tooltip_".concat(t)},i.a.createElement("span",null,l[t].desc))))))})))),g=i.a.createElement("div",{className:e.allContainer,style:t.allContainer},i.a.createElement("div",{className:e.col1,style:t.col1},y[0]),i.a.createElement("div",{className:e.col2,style:t.col2},y[1]))}return g}));const Rn=Object(oe.a)(Ft,re,Dt,(e,t,a)=>({width:lt.sidebar.width,height:e-lt.sidebar.header.height,views:t.info.views,cinfo:a}));var An=Object(r.b)(e=>Rn(e),e=>({handleChange:(t,a)=>{const n={};if(t.replace("#","").split("&").forEach(e=>{const t=e.split("=");n[t[0]]=t[[1]]}),n.nrow&&n.ncol&&n.arr){const t={nrow:parseInt(n.nrow,10),ncol:parseInt(n.ncol,10),arrange:n.arr};e(V(t))}if(n.pg&&e(V({pageNum:parseInt(n.pg,10)})),n.labels){const t=n.labels.split(",");e(M(t))}let i=[];n.sort&&(i=n.sort.split(",").map((e,t)=>{const a=e.split(";");return{order:t+1,name:a[0],dir:a[1]}})),e(U(i));const o={};if(n.filter){n.filter.split(",").forEach(e=>{const t={};e.split(";").forEach(e=>{const a=e.split(":");t[a[0]]=a[[1]]});const n={name:t.var,type:t.type,varType:a[t.var].type};if("select"===t.type)n.orderValue="ct,desc",n.value=t.val.split("#").map(decodeURIComponent);else if("regex"===t.type){const e=a[t.var].levels,i=[],o=new RegExp(decodeURIComponent(t.val),"i");e.forEach(e=>{null!==e.match(o)&&i.push(e)}),n.regex=t.val,n.value=i,n.orderValue="ct,desc"}else if("range"===t.type){const e=t.from?parseFloat(t.from,10):void 0,a=t.to?parseFloat(t.to,10):void 0;n.value={from:e,to:a},n.valid=!0,e&&a&&e>a&&(n.valid=!1)}o[t.var]=n})}e(G({})),e(G(o)),n.fv&&n.fv.split(",").map(t=>e(K(t,"add")))}}))(Object(Ye.a)({rowDesc:{color:"#888",fontStyle:"italic"}})(({height:e,views:t,cinfo:a,handleChange:n})=>i.a.createElement("div",{style:{height:e,overflowY:"auto"}},i.a.createElement(Aa.a,{style:{padding:0}},t.map(e=>i.a.createElement(za.a,{key:e.name,dense:!0,button:!0,onClick:()=>n(e.state,a)},i.a.createElement(Pa.a,{primary:e.name})))))));const zn={sidebarContainer:{transitionProperty:"left",transitionDuration:lt.trans.duration,transitionTimingFunction:lt.trans.timing,position:"absolute",left:lt.sideButtons.width,top:lt.header.height,height:"100%",boxSizing:"border-box",borderRight:"1px solid",borderColor:"".concat(lt.sidebar.borderColor," !important"),background:"#fff",zIndex:999,overflow:"hidden"},hidden:{transitionProperty:"left",transitionDuration:lt.trans.duration,transitionTimingFunction:lt.trans.timing,left:lt.sideButtons.width-lt.sidebar.width},header:{paddingLeft:10,boxSizing:"border-box",fontSize:lt.sidebar.header.fontSize,background:lt.sidebar.header.background,height:lt.sidebar.header.height,lineHeight:"".concat(lt.sidebar.header.height,"px"),color:lt.sidebar.header.color,borderLeft:"1px solid #ccc"},empty:{paddingLeft:8,paddingTop:5}},Pn=Object(oe.a)(Ft,Rt,e=>!(!e.selectedDisplay||""===e.selectedDisplay.name||!e._displayInfo[e.selectedDisplay.name])&&e._displayInfo[e.selectedDisplay.name].isLoaded,zt,(e,t,a,n)=>({styles:{sidebarContainer:{width:lt.sidebar.width*(1+("Filter Panels"===t&&n&&null!==n.cutoff)),height:e}},active:t,displayLoaded:a}));var Fn=Object(r.b)(e=>Pn(e))(Object(Ye.a)(zn)(({classes:e,styles:t,active:a,displayLoaded:n})=>{if(""===a)return i.a.createElement("div",{className:"".concat(e.sidebarContainer," ").concat(e.hidden),style:t.sidebarContainer});let o;if("Configuration"===a)o=i.a.createElement("div",{className:e.empty},"Configuration...");else if(n)switch(a){case"Panel Grid Layout":o=i.a.createElement("div",null,i.a.createElement(Qa,null));break;case"Filter Panels":o=i.a.createElement("div",null,i.a.createElement(Ln,null));break;case"Sort Panels":o=i.a.createElement("div",null,i.a.createElement(nn,null));break;case"Show/Hide Labels":o=i.a.createElement("div",null,i.a.createElement(Wa,null));break;case"Views":o=i.a.createElement("div",null,i.a.createElement(An,null));break;default:o=""}else o=i.a.createElement("div",{className:e.empty},"Load a display...");return i.a.createElement("div",{className:e.sidebarContainer,style:t.sidebarContainer},i.a.createElement("div",{className:e.header},a),o)})),Wn=a(150),Bn=a(317),Hn=a(151),Vn=a.n(Hn),Mn=a(298),Un=a(152),Gn=a.n(Un);class Kn extends i.a.Component{constructor(e){super(e),this.myRef=i.a.createRef(),this.isSelfContained=void 0!==e.panelData&&"__self__"===e.cfg.display_base;let t=[e.curDisplayInfo.info.name];e.relDispPositions.length>0&&(t=e.relDispPositions.map(e=>e.name));const a={panels:{},hover:"",textInputOpen:"",textInputValue:"",inputChangeCounter:0};t.forEach(t=>{"image_src"===e.displayInfo[t].info.panelInterface.type?a.panels[t]={panelContent:e.panelRenderers[t].fn(e.displayInfo[t].info.imgSrcLookup[e.panelKey],e.dims.ww,e.dims.hh,!1,e.panelKey),panelData:e.panelData,loaded:!0}:this.isSelfContained?a.panels[t]={panelContent:e.panelRenderers[t].fn(e.panelData,e.dims.ww,e.dims.hh,!1,e.panelKey),panelData:e.panelData,loaded:!0}:a.panels[t]={loaded:!1,panelContent:null,panelData:null}}),this.state=a}componentDidMount(){const e=this.state.panels,t=this.props,a=t.cfg,n=t.panelKey,i=t.panelRenderers,o=t.dims,l=t.curDisplayInfo,r=t.displayInfo,s=t.relDispPositions;let c=[l.info.name];s.length>0&&(c=s.map(e=>e.name)),c.forEach((t,l)=>{const c=i[t],d=r[t].info.cogInterface;let p=o.ww,h=o.hh;if(s.length>0&&(h=o.hh*s[l].height,p=h/s[l].aspect),e[t].loaded)c.fn(e[t].panelData,p,h,!0,"".concat(n,"_").concat(t));else{let e="".concat(a.cog_server.info.base).concat(d.group);e="".concat(e,"/").concat(d.name),window.__panel__||(window.__panel__={}),window.__panel__["_".concat(n,"_").concat(t)]=e=>{const a=this.state.panels;this.setState({panels:Object(Te.a)(Object(Te.a)({},a),{},{[t]:{panelContent:c.fn(e,p,h,!1,"".concat(n,"_").concat(t)),panelData:e,loaded:!0}})})},"jsonp"===a.cog_server.type?this.xhr=k()({url:"".concat(e,"/jsonp/").concat(n,".jsonp"),callbackName:"__panel_".concat(n,"_").concat(t)}):this.xhr=(m={url:"".concat(e,"/json/").concat(n,".json"),callback:window.__panel__["_".concat(n,"_").concat(t)]},Object(S.a)(m.url,e=>m.callback(e)))}var m});const d=this._panel;d.style.opacity=0,setTimeout(()=>d.style.opacity=1,10)}UNSAFE_componentWillReceiveProps(e){const t=this.state.panels,a=Object.keys(t).every(e=>t[e].loaded),n=this.props.dims,i=e.dims.ww!==n.ww,o=e.curDisplayInfo.info.name;if(a&&i)if("image"===e.panelInterface.type){const a=e.panelRenderers[o],n=Object(Te.a)({},t);0===e.relDispPositions.length&&(n[o].panelContent=a.fn(t[o].panelData,e.dims.ww,e.dims.hh,!1,"".concat(e.panelKey,"_").concat(o))),this.setState({panels:n})}else if("htmlwidget"===e.panelInterface.type){const t=I(e.panelInterface.deps.name);if(t){const a=document.getElementById("widget_".concat(e.panelKey));a&&(a.style.width="".concat(e.dims.ww,"px"),a.style.height="".concat(e.dims.hh,"px"),t.resize(a,e.dims.ww,e.dims.hh))}}}componentDidUpdate(){const e=this.state.panels,t=this.props,a=t.panelKey,n=t.panelRenderers,i=t.dims,o=t.curDisplayInfo,l=t.relDispPositions;let r=[o.info.name];l.length>0&&(r=l.map(e=>e.name)),r.forEach((t,o)=>{if(e[t].loaded){let r=i.ww,s=i.hh;l.length>0&&(s=i.hh*l[o].height,r=s/l[o].aspect);n[t].fn(e[t].panelData,r,s,!0,"".concat(a,"_").concat(t))}})}componentWillUnmount(){const e=this.props,t=e.panelKey,a=e.curDisplayInfo.info.name;this.xhr&&this.xhr.abort(),!this.isSelfContained&&window.__panel__&&window.__panel__["_".concat(t,"_").concat(a)]&&(window.__panel__["_".concat(t,"_").concat(a)]=null)}setTextInputOpen(e){this.setState({textInputOpen:e})}handleHover(e){this.setState({hover:e})}render(){const e=this.props,t=e.classes,a=e.dims,n=e.rowIndex,o=e.iColIndex,l=e.labels,r=e.labelArr,s=e.removeLabel,c=e.curDisplayInfo,d=e.relDispPositions,p=e.panelKey,h=this.state,m=h.panels,g=h.hover,u=h.inputChangeCounter,b=h.textInputOpen,f=c.info.name,v=Object.keys(m).every(e=>m[e].loaded);let y=m[f].panelContent;v&&d.length>0&&(y=i.a.createElement("div",null,d.map(e=>i.a.createElement("div",{key:e.name,style:{position:"absolute",top:e.top*a.hh,left:e.left*a.hh,height:e.height*a.hh,width:e.width*a.hh}},m[e.name].panelContent))));const E=d.length>0?a.contentWidth-6:a.ww,w=d.length>0?1:a.pWidth*o+(o+1)*a.pPad+a.wOffset+2*o+1,x={bounding:{width:E+2,height:a.hh+a.nLabels*a.labelHeight+2,top:a.pHeight*n+(n+1)*a.pPad+2*n,right:w},panel:{width:E,height:a.hh},panelContent:{width:E,height:a.hh},labelTable:{width:E},labelRow:{width:E,height:a.labelHeight,lineHeight:"".concat(a.labelHeight,"px")},labelSpan:{fontSize:a.fontSize,position:"absolute"},labelClose:{fontSize:a.fontSize,lineHeight:"".concat(a.labelHeight,"px")},labelInner:{height:a.labelHeight},labelNameCell:{paddingLeft:a.labelPad/2+2,paddingRIght:a.labelPad/2+2,width:a.labelWidth},labelValueCell:{paddingLeft:a.labelPad/2+2,paddingRIght:a.labelPad/2+2},linkIcon:{textDecoration:"none",fontSize:a.fontSize-2},radioDiv:{transform:"scale(".concat(a.labelHeight/29,")"),transformOrigin:"left top",marginTop:-4}};return i.a.createElement("div",{className:t.bounding,style:x.bounding,ref:e=>{this._panel=e}},i.a.createElement("div",{className:t.panel,style:x.panel},v?y:i.a.createElement(Vn.a,{wait:500},i.a.createElement("div",null,"'loading...'"))),i.a.createElement("div",{ref:this.myRef},i.a.createElement("table",{className:t.labelTable,style:x.labelTable},i.a.createElement("tbody",null,l.map((e,n)=>{let o;const l=i.a.createElement("button",{type:"button",className:t.labelClose,style:Object(Te.a)(Object(Te.a)({},x.labelClose),g!==e.name&&{display:"none"}),onClick:()=>s(e.name,r)},i.a.createElement("i",{className:"icon-times-circle"}));if("href"===e.type)o=i.a.createElement("div",{className:t.labelInner,style:x.labelInner},i.a.createElement("a",{style:Object(Te.a)(Object(Te.a)({},x.labelSpan),{},{textDecoration:"none"}),href:e.value,rel:"noopener noreferrer",target:"_blank"},i.a.createElement("i",{className:"icon-open",style:x.linkIcon})));else if("href_hash"===e.type)o=i.a.createElement("div",{className:t.labelInner,style:x.labelInner},i.a.createElement("a",{style:Object(Te.a)(Object(Te.a)({},x.labelSpan),{},{textDecoration:"none"}),href:"#open_in_same_window",onClick:()=>{window.location.href=e.value,window.location.reload()}},i.a.createElement("i",{className:"icon-open",style:x.linkIcon})));else if("input_radio"===e.type){const a=T(c.info,p,e.name),n=c.info.cogInfo[e.name].options;o=i.a.createElement("div",{className:t.labelInner,style:x.labelInner,title:e.value},i.a.createElement("div",{style:x.radioDiv},i.a.createElement(Ha.a,{"aria-label":e.name,name:e.name,classes:{root:t.formRow},value:localStorage.getItem(a)||"",onClick:t=>{t.target.value&&(L(c.info,t.target.value,p,e.name),document.activeElement.blur(),this.setState({inputChangeCounter:u+1}))},row:!0},n.map(e=>i.a.createElement(Va.a,{key:e,value:e,control:i.a.createElement(Ba.a,{disableRipple:!0,size:"small"}),label:e})))))}else if("input_text"===e.type){const n="".concat(c.info.group,"_:_").concat(c.info.name,"_:_").concat(p,"_:_").concat(e.name),l=i.a.createRef(),r=i.a.createElement("button",{type:"button",className:t.editButton,style:Object(Te.a)({},x.labelClose),onClick:()=>this.setTextInputOpen(e.name)},i.a.createElement(Gn.a,{style:{fontSize:a.fontSize}}));o=i.a.createElement("div",{className:t.labelInner,style:Object(Te.a)(Object(Te.a)({},x.labelInner),{display:"flex",paddingRight:a.fontSize+4}),title:e.value,ref:l},i.a.createElement("div",{className:t.labelP,style:{fontSize:a.fontSize},onClick:()=>this.setTextInputOpen(e.name),role:"button",onKeyDown:()=>{},tabIndex:"-1"},localStorage.getItem(n)||""),i.a.createElement("div",null,r),i.a.createElement(Mn.a,{open:b===e.name,anchorEl:this.myRef.current,onClose:()=>{this.setTextInputOpen(""),L(c.info,this.state.textInputValue,p,e.name),this.setState({inputChangeCounter:u+1})},onEnter:()=>{this.setState({textInputValue:localStorage.getItem(n)||""})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},i.a.createElement("div",{style:{padding:7}},i.a.createElement(fa.a,{id:"outlined-multiline-static",label:"".concat(e.name," ('esc' when complete)"),onChange:e=>{this.setState({textInputValue:e.target.value})},value:this.state.textInputValue,style:{minWidth:300},size:"small",autoFocus:!0,multiline:!0,rows:c.info.cogInfo[e.name].height,variant:"outlined"}))))}else o=i.a.createElement("div",{className:t.labelInner,style:x.labelInner,title:e.value},i.a.createElement("span",{className:t.labelP,style:x.labelSpan},e.value));return i.a.createElement("tr",{key:"".concat(e.name),className:Qt()({[t.labelRow]:!0,[t.labelRowHover]:g===e.name}),style:x.labelRow,onMouseOver:()=>this.handleHover(e.name),onFocus:()=>this.handleHover(e.name),onMouseOut:()=>this.handleHover(""),onBlur:()=>this.handleHover("")},i.a.createElement("td",{className:"".concat(t.labelCell," ").concat(t.labelNameCell),style:x.labelNameCell},i.a.createElement("div",{className:t.labelInner,style:x.labelInner,"data-tip":!0,"data-for":"tooltip_".concat(p,"_").concat(e.name)},i.a.createElement("span",{style:x.labelSpan},e.name)),e.name!==e.desc&&i.a.createElement(Ja.a,{place:"right",id:"tooltip_".concat(p,"_").concat(e.name)},i.a.createElement("span",null,e.desc))),i.a.createElement("td",{className:t.labelCell,style:x.labelValueCell},i.a.createElement("div",{className:t.labelOuter},o,l)))})))))}}Kn.defaultProps=()=>({panelInterface:void 0,panelData:void 0});const Yn={bounding:{transitionProperty:"all",transitionDuration:lt.trans.duration,transitionTimingFunction:lt.trans.timing,position:"absolute",overflow:"hidden",padding:0,boxSizing:"border-box",border:"1px solid #ddd"},panel:{transitionProperty:"all",transitionDuration:lt.trans.duration,transitionTimingFunction:lt.trans.timing,boxSizing:"border-box",textAlign:"center",overflow:"hidden",color:"#bbb"},panelContent:{transitionProperty:"all",transitionDuration:lt.trans.duration,transitionTimingFunction:lt.trans.timing,display:"block"},labelTable:{transitionProperty:"all",transitionDuration:lt.trans.duration,transitionTimingFunction:lt.trans.timing,padding:0,tableLayout:"fixed",borderSpacing:0,boxSizing:"border-box"},labelRow:{transitionProperty:"all",transitionDuration:lt.trans.duration,transitionTimingFunction:lt.trans.timing,background:"#f6f6f6"},labelRowHover:{background:Object(Jt.fade)("#f6f6f6",.4)},labelCell:{paddingTop:0,paddingBottom:0},labelNameCell:{borderRight:"1px solid #fff",fontWeight:400},labelOuter:{position:"relative",overflow:"hidden"},labelInner:{paddingRight:3,overflow:"hidden",whiteSpace:"normal",verticalAlign:"middle",position:"relative",cursor:"default"},labelP:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"100%",margin:0},labelClose:{transition:"1s",position:"absolute",top:0,right:2,cursor:"pointer",border:"none",background:"none",padding:0,margin:0,opacity:.5},editButton:{cursor:"pointer",border:"none",background:"none",padding:0,margin:0,opacity:.5},formRow:{flexWrap:"unset"}};var qn=Object(Ye.a)(Yn)(Kn);const Qn=({classes:e,contentStyle:t,ccd:a,ci:n,cinfo:o,cfg:l,layout:r,labels:s,dims:c,panelRenderers:d,panelInterface:p,sidebar:h,curPage:m,totPages:g,panelData:u,removeLabel:b,setPageNum:f,curDisplayInfo:v,displayInfo:y,relDispPositions:E})=>{let w=i.a.createElement("div",null),x=[v.info.name];E.length>0&&(x=E.map(e=>e.name));const S=x.every(e=>d[e]&&null!==d[e].fn),_=x.every(e=>y[e]&&y[e].isLoaded);if(n&&a&&o&&S&&_&&p){const n=[],x=[];for(let e=0;e<a.length;e+=1){n.push(a[e].panelKey);const t=[];for(let n=0;n<s.length;n+=1)t.push({name:s[n],value:a[e][s[n]],type:o[s[n]].type,desc:o[s[n]].desc});x.push(t)}const S=[];for(let e=0;e<a.length;e+=1){let t,a;"row"===r.arrange?(t=Math.floor(e/r.ncol),a=e%r.ncol):(t=e%r.nrow,a=Math.floor(e/r.nrow)),S.push({rowIndex:t,colIndex:a,iColIndex:r.ncol-a-1,key:n[e],labels:x[e]})}S.sort((e,t)=>e.key>t.key?1:t.key>e.key?-1:0);let _="";if("htmlwidget"===p.type&&(_="_".concat(r.nrow,"_").concat(r.ncol,"_").concat(h,"_").concat(s.length),_+="_".concat(t.width,"_").concat(t.height)),E.length>0){const e=E.map(e=>e.name).join("_");let a="";a=E.map(e=>e.left+e.top+e.width+e.height).reduce((e,t)=>e+t),_="".concat(_,"_").concat(e,"_").concat(a,"_").concat(s.length),_+="_".concat(t.height)}w=i.a.createElement(Wn.a,{onSwipedRight:()=>f("right",m,g),onSwipedLeft:()=>f("left",m,g)},i.a.createElement("div",{className:e.content,style:t},S.map(e=>i.a.createElement(qn,{key:"".concat(e.key).concat(_),cfg:l,panelKey:e.key,labels:e.labels,labelArr:s,panelRenderers:d,panelData:u[e.key],panelInterface:p,removeLabel:b,dims:c,rowIndex:e.rowIndex,iColIndex:e.iColIndex,curDisplayInfo:v,displayInfo:y,relDispPositions:E}))))}return w};Qn.defaultProps=()=>({ci:void 0,panelInterface:void 0});const Jn={content:{background:"#fdfdfd",position:"absolute",top:lt.header.height,right:0,boxSizing:"border-box",padding:0}},$n=Object(oe.a)(Pt,Ft,_e,e=>e._cogDataMutable.iface,ue,xe,be,Dt,fe,e=>e.panelRenderers,re,Rt,de,Oe,pe,e=>e._localPanels,e=>e.relDispPositions,e=>e._displayInfo,(e,t,a,n,i,o,l,r,s,c,d,p,h,m,g,u,b,f)=>{const v=lt.content.panel.pad;let y=Math.round(e/i.ncol,0),E=Math.round(y*o,0);E*i.nrow>t&&(E=Math.round(t/i.nrow,0),y=Math.round(E/o,0));let w=.08*Math.min(y,E);w=Math.max(Math.min(w,26),13);const x=w/1.625-4,S=w-x,_=l.length,O=(v+2)*(i.ncol+1),C=(v+2)*(i.nrow+1)+_*w*i.nrow;let k=Math.round((e-O)/i.ncol,0),I=Math.round(k*o,0),N=0;I*i.nrow+C>t&&(I=Math.round((t-C)/i.nrow,0),k=Math.round(I/o,0),N=(e-(k*i.ncol+O))/2),b.length>0&&(I=t-C,k=e-O,N=0);const D=u,j=((e,t)=>{const a=document.createElement("span");a.style.fontWeight="normal",a.style.fontSize="".concat(t,"px"),a.style.fontFamily="Open Sans",a.style.visibility="hidden";const n=document.body.appendChild(a),i=e.map(e=>(n.innerHTML=e,n.offsetWidth));return document.body.removeChild(n),Object(Bn.a)(i)})(l,S)+x;return{contentStyle:{width:e,height:t},ccd:a,ci:n,cinfo:r,cfg:s,layout:i,labels:l,dims:{ww:k,hh:I,labelHeight:w,labelWidth:j,labelPad:x,fontSize:S,nLabels:_,pWidth:k,pHeight:I+_*w,wOffset:N,hOffset:lt.header.height,pPad:v,contentWidth:e},panelRenderers:c,panelInterface:d.info.panelInterface,sidebar:p,curPage:h,totPages:Math.ceil(m/g),panelData:D,curDisplayInfo:d,displayInfo:f,relDispPositions:b}});var Xn=Object(r.b)(e=>$n(e),e=>({removeLabel:(t,a)=>{const n=a.indexOf(t);if(n>-1){const t=Object.assign([],a);t.splice(n,1),e(M(t))}},setPageNum:(t,a,n)=>{let i=a;"right"===t?(i-=1,i<1&&(i+=1)):(i+=1,i>n&&(i-=1)),e(V({pageNum:i}))}}))(Object(Ye.a)(Jn)(Qn));const Zn=Object(oe.a)(Tt,Lt,(e,t)=>({width:e,height:t}));var ei=Object(r.b)(e=>Zn(e))(Object(Ye.a)({body:{position:"absolute",top:0,left:0,borderRight:"1px solid #ddd",boxSizing:"border-box"}})(({classes:e,width:t,height:a})=>i.a.createElement("div",{className:e.body,style:{width:t,height:a}},i.a.createElement(Ra,null),i.a.createElement(Fn,null),i.a.createElement(Xn,null))));const ti={wrapper:{border:10,boxSizing:"border-box",display:"flex",textDecoration:"none",marginLeft:3,marginTop:4,padding:0,outline:"none",borderRadius:10,whiteSpace:"nowrap",width:"-webkit-fit-content",background:lt.footer.button.background,height:22,transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms"},label:{color:lt.footer.button.color,fontSize:12,fontWeight:400,lineHeight:"20px",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",WebkitUserSelect:"none"},text:{paddingLeft:5,fontSize:11,fontStyle:"italic"},closeIcon:{display:"inline-block",color:"rgba(0, 0, 0, 0.22)",fill:"rgba(0, 0, 0, 0.22)",height:21,width:21,transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",cursor:"pointer",margin:"1px 1px 0px -8px",WebkitUserSelect:"none","&:hover":{color:Object(Jt.fade)("rgba(0, 0, 0, 0.22)",.4),fill:Object(Jt.fade)("rgba(0, 0, 0, 0.22)",.4)}},indIcon:{paddingRight:5}};var ai=Object(r.b)(()=>({}),e=>({handleStateClose:t=>{"sort"===t.type?(e(U(t.index)),e(V({pageNum:1}))):"filter"===t.type&&(e(K(t.label,"remove")),e(G(t.label)),e(V({pageNum:1})))}}))(Object(Ye.a)(ti)(({classes:e,label:t,icon:a,text:n,index:o,type:l,handleStateClose:r})=>{let s="";""!==a&&(s=i.a.createElement("i",{className:"".concat(a," ").concat(e.indIcon)}));let c="";return""!==n&&(c=i.a.createElement("span",{className:e.text},"(".concat(n,")"))),i.a.createElement("div",{type:"button",className:e.wrapper},i.a.createElement("span",{className:e.label},s,t,c),i.a.createElement("svg",{viewBox:"0 0 24 24",className:e.closeIcon,key:"icon",onClick:()=>r({label:t,index:o,type:l})},i.a.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"})))})),ni=a(226),ii=a(154),oi=a.n(ii),li=a(153),ri=a.n(li);const si=Object(Ea.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"25ch"}},button:{margin:e.spacing(1)}}));function ci({open:e,handleClose:t,displayInfo:a}){const n=si(),o=i.a.useState(localStorage.getItem("__trelliscope_username")||""),l=Object(ua.a)(o,2),s=l[0],c=l[1],d=i.a.useState(localStorage.getItem("__trelliscope_email")||""),p=Object(ua.a)(d,2),h=p[0],m=p[1],g=i.a.useState(localStorage.getItem("__trelliscope_jobtitle")||""),u=Object(ua.a)(g,2),b=u[0],f=u[1],v=i.a.useState(localStorage.getItem("__trelliscope_otherinfo")||""),y=Object(ua.a)(v,2),E=y[0],w=y[1],x=i.a.useState(0),S=Object(ua.a)(x,2),_=S[0],O=S[1],C=i.a.useState(!1),k=Object(ua.a)(C,2),I=k[0],N=k[1],D=Object(r.c)(ce);if(!D.isLoaded||void 0===D.crossfilter)return"";if(!a.has_inputs||"localStorage"!==a.input_type)return"";const j="".concat(a.group,"_:_").concat(a.name),T=new RegExp("^".concat(j)),L=a.input_csv_vars||[],R={},A=[];Object.keys(localStorage).forEach(e=>{if(T.test(e)){const t=e.split("_:_"),a=t[2];void 0===R[a]&&(R[a]={}),R[a][t[3]]=localStorage.getItem(e),A.indexOf(t[3])<0&&A.push(t[3])}});const z=["panelKey"],P=D.crossfilter.all(),F=P.map(e=>e.panelKey);z.push(...L,...A),z.push("fullname","email","jobtitle","otherinfo","timestamp");const W=Object.keys(R).map((e,t)=>{const a=[];if(L.length>0){const t=F.indexOf(e);a.push(L.map(e=>P[t][e]))}const n=A.map(t=>R[e][t]?'"'.concat(R[e][t].replace(/"/g,'""'),'"'):""),i=[];return 0===t?i.push('"'.concat((localStorage.getItem("__trelliscope_username")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_email")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_jobtitle")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_otherinfo")||"").replace(/"/g,'""'),'"'),(new Date).toISOString()):i.push("","","","",""),[e,...a,n,i]});return i.a.createElement("div",null,i.a.createElement(at.a,{open:e,onClose:()=>{O(0),t()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement(tt.a,{id:"alert-dialog-title"},"Export user inputs"),i.a.createElement(nt.a,{dividers:!0},i.a.createElement(ht.a,{activeStep:_,alternativeLabel:!0},["User info","Download csv","Compose email"].map(e=>i.a.createElement(mt.a,{key:e},i.a.createElement(ni.a,null,e)))),0===_&&i.a.createElement("div",null,i.a.createElement(ba.a,null,"Before exporting the inputs you have provided, we would like to gather some information about you. Please provide at least your full name, after which you will be able to click the 'Export' tab in this window to proceed with the export."),i.a.createElement("div",null,i.a.createElement(fa.a,{style:{marginBottom:15},required:!0,label:"Full Name",fullWidth:!0,value:s,onChange:e=>{c(e.target.value),localStorage.setItem("__trelliscope_username",e.target.value)}}),i.a.createElement(fa.a,{style:{marginBottom:15},label:"Email Address",fullWidth:!0,value:h,onChange:e=>{m(e.target.value),localStorage.setItem("__trelliscope_email",e.target.value)}}),i.a.createElement(fa.a,{style:{marginBottom:15},label:"Job Title",fullWidth:!0,value:b,onChange:e=>{f(e.target.value),localStorage.setItem("__trelliscope_jobtitle",e.target.value)}}),i.a.createElement(fa.a,{style:{marginBottom:15},multiline:!0,rows:3,label:"Additional Contact Information",fullWidth:!0,value:E,onChange:e=>{w(e.target.value),localStorage.setItem("__trelliscope_otherinfo",e.target.value)}}))),1===_&&i.a.createElement("div",null,i.a.createElement(ba.a,{id:"alert-dialog-description"},i.a.createElement("p",{style:{marginTop:0}},"A csv file of the inputs you provided has been created. By clicking the 'Compose Email' button below, an email will be drafted and opened in your email client to relay this csv file back to us, at ".concat(a.input_email,".")),i.a.createElement("p",null,"To complete the email, use the 'Download csv' button to download the csv and add it as an attachment to the email before sending. As an alternative, you can download the csv file and compose your own email, sending it to us at ".concat(a.input_email,"."))),i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(ot.a,{variant:"contained",color:"primary",className:n.button,endIcon:i.a.createElement(ri.a,null),onClick:()=>{const e=[z.join(","),...W.map(e=>e.join(","))].join("\n"),t=new Blob([e],{type:"text/csv"}),n=document.createElement("a");n.download="".concat(a.name,"_").concat((new Date).toISOString().split("T")[0],".csv"),n.href=window.URL.createObjectURL(t),n.click(),N(!0)}},"Download CSV"))),2===_&&i.a.createElement("div",null,i.a.createElement(ba.a,{id:"alert-dialog-description"},i.a.createElement("p",{style:{marginTop:0}},"By clicking the 'Compose Email' button below, an email will be drafted and opened in your email client to relay this csv file back to us, at ".concat(a.input_email,".")),i.a.createElement("p",null,i.a.createElement("strong",null,"Note: You must manually attach the csv file downloaded in the previous step to this email prior to sending."))),i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(ot.a,{variant:"contained",color:"primary",className:n.button,endIcon:i.a.createElement(oi.a,null),onClick:()=>{const e="From: ".concat(s,"%0D%0A%0D%0AEmail: ").concat(h,"%0D%0A%0D%0AJob Title: ").concat(encodeURIComponent(b),"%0D%0A%0D%0AOther contact info: ").concat(encodeURIComponent(E),"%0D%0A%0D%0ADisplay: ").concat(a.group," -> ").concat(a.name,"%0D%0A%0D%0A(attach downloaded csv file here before sending)"),t=document.createElement("a");t.href="mailto:".concat(a.input_email,"?subject=").concat("Trelliscope input","&body=").concat(e),t.click()}},"Compose Email"))),i.a.createElement("div",{style:{textAlign:"right"}},i.a.createElement(ot.a,{disabled:0===_,onClick:()=>{O(e=>e-1)},className:n.button},"Back"),_<=1&&i.a.createElement(ot.a,{disabled:0===_&&""===s||1===_&&!I,variant:"contained",color:"primary",onClick:()=>{O(e=>e+1)},className:n.button},"Next"))),i.a.createElement(it.a,null,i.a.createElement(ot.a,{onClick:()=>{Object.keys(localStorage).forEach(e=>{T.test(e)&&localStorage.removeItem(e)})}},"Clear all inputs"),i.a.createElement(ot.a,{onClick:()=>{O(0),t()},color:"primary",autoFocus:!0},"Close"))))}const di=({classes:e,style:t,sort:a,filter:n,nFilt:o,nPanels:l,displayInfo:r})=>{const s=i.a.useState(!1),c=Object(ua.a)(s,2),d=c[0],p=c[1];let h="",m="",g="";return a.length>0&&(h=i.a.createElement("div",{className:e.sectionWrapper},i.a.createElement("div",{className:e.sectionText},"Sorting on:"),i.a.createElement("div",{className:e.chipWrapper},a.map((e,t)=>i.a.createElement(ai,{key:"".concat(e.name,"_sortchip"),label:e.name,icon:e.icon,text:"",index:t,type:"sort"}))))),n.length>0&&(m=i.a.createElement("div",{className:e.sectionWrapper},i.a.createElement("div",{className:e.sectionText},"Filtering on:"),i.a.createElement("div",{className:e.chipWrapper},n.map((e,t)=>i.a.createElement(ai,{key:"".concat(e.name,"_filterchip"),label:e.name,icon:"",text:e.text,index:t,type:"filter"}))),i.a.createElement("div",{className:e.filterText},"(".concat(o," of ").concat(l," panels)")))),n.length>0&&a.length>0&&(g=i.a.createElement("div",{className:e.spacer})),i.a.createElement("div",{className:e.wrapper,style:t},i.a.createElement("div",{className:e.inner},h,g,m),r.has_inputs&&"localStorage"===r.input_type&&i.a.createElement("div",{className:e.buttonDiv},i.a.createElement(ot.a,{size:"small",variant:"contained",color:"primary",onClick:()=>{p(!0)}},"Export Inputs")),i.a.createElement(ci,{open:d,handleClose:()=>{p(!1)},displayInfo:r}))};di.defaultProps=()=>({nPanels:0});const pi={wrapper:{position:"absolute",boxSizing:"border-box",left:0,height:lt.footer.height,paddingLeft:10,margin:0,lineHeight:"".concat(lt.footer.height,"px"),fontSize:.5*lt.footer.height,fontWeight:300,background:lt.footer.background,color:lt.footer.color,display:"flex",flexDirection:"row",overflowX:"auto",overflowY:"hidden",zIndex:1001},inner:{display:"flex",flexDirection:"row",whiteSpace:"nowrap",paddingRight:10},sectionWrapper:{display:"flex",flexDirection:"row"},chipWrapper:{display:"flex",flexDirection:"row"},sectionText:{marginRight:3},spacer:{width:12},filterText:{marginLeft:5},buttonDiv:{position:"absolute",right:0,bottom:0}},hi=Object(oe.a)(ge,re,(e,t)=>{const a=[];for(let n=0;n<e.length;n+=1){const i=e[n].name,o=t.info.cogInfo[i].type;let l="icon-sort-amount";"factor"===o?l="icon-sort-alpha":"numeric"===o&&(l="icon-sort-numeric"),l="".concat(l,"-").concat(e[n].dir),a.push({name:i,icon:l})}return a}),mi=Object(oe.a)(e=>e.filter,re,(e,t)=>{const a=Object.keys(e.state),n=[];for(let i=0;i<a.length;i+=1){const o=e.state[a[i]];if(void 0!==o.value){let e="";if("numeric"===o.varType)void 0===o.value.from&&void 0!==o.value.to?e="< ".concat(o.value.to):void 0!==o.value.from&&void 0===o.value.to?e="> ".concat(o.value.from):void 0!==o.value.from&&void 0!==o.value.to&&(e="".concat(o.value.from," -- ").concat(o.value.to));else if("factor"===o.varType){const a=15,n=o.value.length;let i=0,l=0;for(;l<n&&i<=a;)i=i+o.value[l].length+2,l+=1;if(l===n)e=o.value.sort().join(", ");else{const a=t.info.cogInfo[o.name].levels.length;e="".concat(o.value.length," of ").concat(a)}}n.push({name:a[i],text:e})}}return n}),gi=Object(oe.a)(Tt,hi,mi,Oe,re,ye,Ft,(e,t,a,n,i,o,l)=>({style:{width:e-(o?0:lt.footer.height),top:l+lt.header.height},sort:t,filter:a,nFilt:n,displayInfo:i.info,nPanels:i.info.n}));var ui=Object(r.b)(e=>gi(e))(Object(Ye.a)(pi)(di));class bi extends i.a.Component{constructor(e){super(e),this.yOffset=window.pageYOffset}componentDidMount(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.sidebar,i=e.dialog,o=e.appId,l=e.toggleFullscreen,r=e.ww,s=e.hh;t||!a||""!==n||i||Xe.a.bindGlobal("esc",()=>l(!1,o,{width:r,height:s},this.yOffset))}UNSAFE_componentWillReceiveProps(e){const t=this.props,a=t.singlePageApp,n=t.ww,i=t.hh;a||(e.fullscreen&&""===e.sidebar&&!e.dialog&&Xe.a.bindGlobal("esc",()=>e.toggleFullscreen(!1,e.appId,{width:n,height:i},this.yOffset)),e.dialog&&Xe.a.unbind("esc"))}componentWillUnmount(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.sidebar,i=e.dialog;t||!a||""!==n||i||Xe.a.unbind("esc")}render(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.appId,o=e.ww,l=e.hh,r=e.toggleFullscreen;if(t)return null;const s=this.props.classes,c=a?"icon-minimize":"icon-maximize";return i.a.createElement("button",{type:"button",className:s.button,onClick:()=>{a||(this.yOffset=window.pageYOffset),r(!a,n,{width:o,height:l},this.yOffset)}},i.a.createElement("i",{className:"".concat(c," ").concat(s.icon)}))}}const fi={button:{position:"absolute",right:0,bottom:0,textAlign:"center",background:Object(Jt.emphasize)(lt.footer.background,.2),width:lt.footer.height,height:lt.footer.height,cursor:"pointer",border:"none",transition:"all 100ms ease-in","&:hover":{background:Object(Jt.emphasize)(lt.footer.background,.3)}},icon:{color:Object(Jt.emphasize)(lt.footer.background,.8),fontSize:"".concat(lt.footer.height-16,"px")}},vi=Object(oe.a)(Rt,we,Ee,ve,ye,e=>e.ui.origWidth,e=>e.ui.origHeight,(e,t,a,n,i,o,l)=>({sidebar:e,dialog:t,fullscreen:a,appId:n,singlePageApp:i,ww:o,hh:l}));var yi=Object(r.b)(e=>vi(e),e=>({toggleFullscreen:(t,a,n,i)=>{const o=document.getElementById(a),l={};if(t){w(document.body,"trelliscope-fullscreen-body"),w(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html"),w(o,"trelliscope-fullscreen-el"),l.width=window.innerWidth,l.height=window.innerHeight;const e=document.getElementById("trelliscope-fullscreen-div");e.style.display="block",e.appendChild(o)}else x(document.body,"trelliscope-fullscreen-body"),x(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html"),x(o,"trelliscope-fullscreen-el"),l.width=n.width,l.height=n.height,document.getElementById("".concat(o.id,"-parent")).appendChild(o),document.getElementById("trelliscope-fullscreen-div").style.display="none",window.scrollTo(window.pageXOffset,i);e((e=>({type:"SET_FULLSCREEN",fullscreen:e}))(t)),e(A(l))}}))(Object(Ye.a)(fi)(bi)),Ei=a(313);const wi=Object(oe.a)(e=>e.errorMsg,e=>({errorMsg:e}));var xi=Object(r.b)(e=>wi(e),e=>({handleClose:()=>{e(te(""))}}))(({errorMsg:e,handleClose:t})=>i.a.createElement(Ei.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:""!==e,onClose:t,SnackbarContentProps:{"aria-describedby":"message-id"},message:i.a.createElement("span",{id:"message-id"},e),action:[i.a.createElement(ot.a,{key:"undo",color:"secondary",dense:!0,onClick:t},"Close")]}));var Si=()=>i.a.createElement("div",null,i.a.createElement(ka,null),i.a.createElement(ei,null),i.a.createElement(ui,null),i.a.createElement(yi,null),i.a.createElement(xi,null));const _i=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Oi(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}const Ci=(e,t,a)=>{let n=!0,o={},m=!1;void 0!==a&&("boolean"===typeof a.logger?n=a.logger:void 0!==a.logger&&(o=a.logger),void 0!==a.callbacks&&(m=!0));const u=document.getElementById(e);w(u,"trelliscope-app"),w(u,"trelliscope-app-container"),"relative"!==u.style.position&&(u.style.position="relative"),"hidden"!==u.style.overflow&&(u.style.overflow="hidden"),u.style["font-family"]='"Open Sans", sans-serif',u.style["font-weight"]=300,u.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)";const f=void 0===u.style.height||""===u.style.height||"100%"===u.style.height,v=void 0===u.style.width||""===u.style.width||"100%"===u.style.width;let E=!1,x=!1;if(u.classList.contains("trelliscope-not-spa")||!f&&!v){const e=document.createElement("div");if(e.style.width="100%",e.style.height="100%",e.style.display="none",e.id="trelliscope-fullscreen-div",document.getElementsByTagName("body")[0].appendChild(e),f){0===[].slice.call(u.parentNode.childNodes).map(e=>3!==e.nodeType&&8!==e.nodeType).reduce((e,t)=>e+t)-1&&(u.style.height="".concat(u.parentNode.clientHeight,"px"),u.style.width="".concat(u.parentNode.clientWidth,"px"))}const t=u.parentNode,a=document.createElement("div");a.id="".concat(u.id,"-parent"),t.replaceChild(a,u),a.appendChild(u)}else E=!0,x=!0,u.style.width="100%",u.style.height="100%",w(document.body,"trelliscope-fullscreen-body"),w(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html");const S={};E?(S.width=window.innerWidth,S.height=window.innerHeight):(S.width=u.clientWidth,S.height=u.clientHeight),u.classList.contains("trelliscope-not-spa")||!f&&!v||(E=!0,x=!0);const _=[c.a,je];if(n){const e=Object(d.createLogger)(o);_.push(e)}if(m){const e=Ce(a.callbacks);_.push(e)}E&&_.push(y);const C=Object(s.d)(Ke,{appId:e,singlePageApp:E,fullscreen:x},Object(s.a)(..._));C.dispatch(A(S)),C.dispatch(z(S)),C.dispatch(((e="config.jsonp",t="",a=!1)=>n=>{const i=a?window.location.hash:"";if(!("string"===typeof e||e instanceof String)){n(P(e.config)),n(Y(e.displayList));const t=e.displayList[0].name,a=e.displayList[0].group,i=e.displayList[0].desc;n(q(t,a,i)),n($(t,a));const o=e.displayObj.cogInterface;n(X(t,a,e.displayObj)),n(Z(o)),n({type:"SET_LOCAL_PANELS",dat:e.panels}),ae(o,e.cogData,e.displayObj,n,""),ne(e.displayObj,e.config,n)}else{n({type:"REQUEST_CONFIG"});const o="__loadDisplayList__".concat(t),l="__loadTrscopeConfig__".concat(t),r=e.replace(/[^\/]*$/,""),s=e=>{let t=e;return/^https?:\/\/|^file:\/\/|^\//.test(e)||(t=r,""!==e&&(t+="".concat(e,"/"))),t};window[l]=e=>{if(e.display_base=s(e.display_base),e.config_base=r,e.cog_server.info.base=s(e.cog_server.info.base),n(P(e)),e.ga_id&&O.a.initialize(e.ga_id),!0===e.require_token){const e="".concat(window.devicePixelRatio||"").concat(navigator.userAgent.replace(/\D+/g,"")),t="".concat(navigator.language.length||"").concat(window.screen.colorDepth||""),a="".concat((new Date).getTimezoneOffset()).concat(navigator.platform.length||""),i="".concat(window.screen.height||"").concat(window.screen.width||"").concat(window.screen.pixelDepth||""),o="".concat((new Date).toLocaleDateString().replace(/\D+/g,"")),l="".concat(e).concat(t).concat(a).concat(i).concat(o);if(localStorage.getItem("TRELLISCOPE_TOKEN")!==l)return void n(te("Visualization could not be loaded because it is not embedded in a properly authenticated website."))}window[o]=o=>{o.sort((e,t)=>(void 0===e.order?1:e.order)>(void 0===t.order?1:t.order)?1:-1),n(Y(o));const l={};if(i.replace("#","").split("&").forEach(e=>{const t=e.split("=");l[t[0]]=t[[1]]}),l.display){const a=o.map(e=>e.name).indexOf(l.display);if(a>-1){const l=o[a];n(q(l.name,l.group,l.desc)),n(ie(l.name,l.group,e,t,i))}}else a&&o.length>1&&(n(W(!0)),n(B(!0)))},"jsonp"===e.data_type?k()({url:"".concat(e.display_base,"displayList.jsonp"),callbackName:o,error:e=>n(te("Couldn't load display list: ".concat(e.url)))}):R({url:"".concat(e.display_base,"displayList.json"),callback:window[o]}).on("error",e=>n(te("Couldn't load display list: ".concat(e.target.responseURL))))};const c=/\.([0-9a-z]+)(?:[\?#]|$)/i,d=e.match(c)[0];".jsonp"===d?k()({url:e,callbackName:l,error:e=>n(te("Couldn't load config: ".concat(e.url)))}):".json"===d?R({url:e,callback:window[l]}):n(te("Config specified as ".concat(e," must have extension '.json' or '.jsonp'")))}})(t,e,E)),window.addEventListener("resize",()=>{C.getState().fullscreen&&C.dispatch(A({height:window.innerHeight,width:window.innerWidth}))});const I=Object(p.a)({palette:{primary:{light:g.a.A100,main:g.a.A200},secondary:{light:b.a[200],main:b.a[700]}},typography:{fontFamily:'"Open Sans", sans-serif',fontWeightLight:200,fontWeightRegular:300,fontWeightMedium:400}});return l.a.render(i.a.createElement(h.a,{theme:I},i.a.createElement(r.a,{store:C},i.a.createElement(Si,null))),document.getElementById(e)),{resize:(e,t)=>{u.style.height="".concat(t,"px"),u.style.width="".concat(e,"px"),C.dispatch(z({width:e,height:t})),C.dispatch(A({width:e,height:t}))},setLayout:(e,t)=>{C.dispatch(V({nrow:e,ncol:t}))},currentCogs:()=>_e(C.getState())}};window.trelliscopeApp=Ci,Ci("80222985","_test/gapminder_coggroups/config.jsonp",{logger:!0}),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat("","/service-worker.js");_i?(!function(e,t){fetch(e).then(a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):Oi(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Oi(t,e)})}}()}},[[183,1,2]]]);
//# sourceMappingURL=main.c951d10a.chunk.js.map